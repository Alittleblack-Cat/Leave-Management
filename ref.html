<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
  </head>
  <body>
    <!DOCTYPE html>
    <br>
    <html lang="th">
      <br>
      <head>
        <br>
        <meta charset="UTF-8">
        <br>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <br>
        <title>ระบบจัดการลาหยุดงาน</title>
        <link rel="stylesheet" href="../css/main.css">
        <br>
        <script src="https://cdn.tailwindcss.com"></script>
        <br>
        
        <br>
      </head>
      <br>
      <body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
        <br>
        <!-- Notification Bar -->
        <br>
        <div id="notificationBar" class="fixed top-0 left-0 right-0 z-50" style="display: none;">
          <br>
          <div class="bg-yellow-500 text-white px-4 py-3 text-center notification-alert">
            <br>
            <div class="flex items-center justify-center">
              <br>
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <br>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5v-5z"></path>
                <br>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                <br>
              </svg>
              <br>
              <span id="notificationText"></span>
              <br>
              <button onclick="hideNotification()" class="ml-4 text-white hover:text-gray-200">
                <br>
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <br>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                  <br>
                </svg>
                <br>
              </button>
              <br>
            </div>
            <br>
          </div>
          <br>
        </div>
        <br>
        <br>
        <div class="container mx-auto px-4 py-8 max-w-6xl">
          <br>
          <!-- Header -->
          <br>
          <div class="text-center mb-8 relative">
            <br>
            <h1 class="text-4xl font-bold text-gray-800 mb-2">ระบบจัดการลาหยุดงาน</h1>
            <br>
            <p class="text-gray-600 mb-4">ระบบบริหารจัดการการลาหยุดงานแบบครบวงจร</p>
            <br>
          </div>
          <br>
          <br>
          <!-- Navigation Tabs -->
          <br>
          <div id="navigationTabs" class="bg-white rounded-xl shadow-lg p-2 mb-8 flex space-x-2">
            <br>
            <button id="employeeTab" onclick="switchTab('employee')" class="flex-1 py-3 px-4 rounded-lg font-medium transition-colors bg-blue-600 text-white">undefined<br> พนักงานundefined<br>undefined</button>undefined<br>undefined<button id="managerTab" onclick="switchTab('manager')" class="flex-1 py-3 px-4 rounded-lg font-medium transition-colors text-gray-600 hover:bg-gray-100">undefined<br> ผู้จัดการundefined<br>undefined</button>undefined<br>undefined<button id="adminTab" onclick="switchTab('admin')" class="flex-1 py-3 px-4 rounded-lg font-medium transition-colors text-gray-600 hover:bg-gray-100">undefined<br> ผู้ดูแลระบบundefined<br>undefined</button>undefined<br>undefined
          </div>undefined<br>undefined<br>undefined
          <!-- Employee Login -->undefined<br>undefined
          <div id="employeeLogin" class="bg-gradient-to-br from-white via-blue-50 to-indigo-100 rounded-2xl shadow-2xl p-8 mb-8 border border-blue-200">undefined<br>undefined<div class="text-center mb-6">undefined<br>undefined<div class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full shadow-lg mb-4">undefined<br>undefined<span class="text-3xl text-white">👤</span>undefined<br>undefined</div>undefined<br>undefined<h2 class="text-3xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent mb-2">undefined<br> เข้าสู่ระบบพนักงานundefined<br>undefined</h2>undefined<br>undefined<p class="text-gray-600">เลือกชื่อของคุณเพื่อเข้าสู่ระบบ</p>undefined<br>undefined</div>undefined<br>undefined<br>undefined<div class="space-y-6">undefined<br>undefined<div>undefined<br>undefined<label class="block text-sm font-semibold text-gray-700 mb-3">เลือกชื่อผู้ใช้</label>undefined<br>undefined<input type="text" id="employeeUsername" placeholder="พิมพ์ชื่อของคุณ หรือคลิกเลือกจากรายชื่อด้านล่าง" class="w-full px-6 py-4 border-2 border-blue-200 rounded-xl focus:ring-4 focus:ring-blue-300 focus:border-blue-500 transition-all duration-300 text-lg font-medium shadow-inner bg-white" onkeypress="handleEnterKey(event, 'employee')">undefined<br>undefined</div>undefined<br>undefined<br>undefined<button onclick="employeeLogin()" class="w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-bold py-4 px-8 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl text-lg">undefined<br>undefined<span class="flex items-center justify-center">undefined<br>undefined<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">undefined<br>undefined<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"></path>undefined<br>undefined</svg>undefined<br> เข้าสู่ระบบundefined<br>undefined</span>undefined<br>undefined</button>undefined<br>undefined</div>undefined<br>undefined<br>undefined<div class="mt-8">undefined<br>undefined<div class="text-center mb-4">undefined<br>undefined<h3 class="text-lg font-bold text-gray-800 mb-2">👥 รายชื่อพนักงานทั้งหมด</h3>undefined<br>undefined<p class="text-sm text-gray-600">คลิกที่ชื่อเพื่อเลือก</p>undefined<br>undefined</div>undefined<br>undefined<br>undefined<div class="bg-white rounded-xl p-6 shadow-inner border-2 border-blue-100">undefined<br>undefined<div class="grid grid-cols-2 md:grid-cols-3 gap-3">undefined<br>undefined<button onclick="selectEmployee('แม่เปิ้ล')" class="employee-btn bg-gradient-to-r from-pink-100 to-rose-100 hover:from-pink-200 hover:to-rose-200 border-2 border-pink-200 rounded-lg p-3 text-left transition-all duration-200 transform hover:scale-105 hover:shadow-md">undefined<br>undefined<div class="flex items-center">undefined<br>undefined<span class="text-2xl mr-2">🍎</span>undefined<br>undefined<span class="font-semibold text-pink-800">แม่เปิ้ล</span>undefined<br>undefined</div>undefined<br>undefined</button>undefined<br>undefined<br>undefined<button onclick="selectEmployee('น้าจอส')" class="employee-btn bg-gradient-to-r from-orange-100 to-amber-100 hover:from-orange-200 hover:to-amber-200 border-2 border-orange-200 rounded-lg p-3 text-left transition-all duration-200 transform hover:scale-105 hover:shadow-md">undefined<br>undefined<div class="flex items-center">undefined<br>undefined<span class="text-2xl mr-2">🧡</span>undefined<br>undefined<span class="font-semibold text-orange-800">น้าจอส</span>undefined<br>undefined</div>undefined<br>undefined</button>undefined<br>undefined<br>undefined<button onclick="selectEmployee('น้าปุ้ย')" class="employee-btn bg-gradient-to-r from-green-100 to-emerald-100 hover:from-green-200 hover:to-emerald-200 border-2 border-green-200 rounded-lg p-3 text-left transition-all duration-200 transform hover:scale-105 hover:shadow-md">undefined<br>undefined<div class="flex items-center">undefined<br>undefined<span class="text-2xl mr-2">🌿</span>undefined<br>undefined<span class="font-semibold text-green-800">น้าปุ้ย</span>undefined<br>undefined</div>undefined<br>undefined</button>undefined<br>undefined<br>undefined<button onclick="selectEmployee('แน็ตตี้')" class="employee-btn bg-gradient-to-r from-purple-100 to-violet-100 hover:from-purple-200 hover:to-violet-200 border-2 border-purple-200 rounded-lg p-3 text-left transition-all duration-200 transform hover:scale-105 hover:shadow-md">undefined<br>undefined<div class="flex items-center">undefined<br>undefined<span class="text-2xl mr-2">💜</span>undefined<br>undefined<span class="font-semibold text-purple-800">แน็ตตี้</span>undefined<br>undefined</div>undefined<br>undefined</button>undefined<br>undefined<br>undefined<button onclick="selectEmployee('เกด')" class="employee-btn bg-gradient-to-r from-blue-100 to-cyan-100 hover:from-blue-200 hover:to-cyan-200 border-2 border-blue-200 rounded-lg p-3 text-left transition-all duration-200 transform hover:scale-105 hover:shadow-md">undefined<br>undefined<div class="flex items-center">undefined<br>undefined<span class="text-2xl mr-2">💙</span>undefined<br>undefined<span class="font-semibold text-blue-800">เกด</span>undefined<br>undefined</div>undefined<br>undefined</button>undefined<br>undefined<br>undefined<button onclick="selectEmployee('พี่เจ้ย')" class="employee-btn bg-gradient-to-r from-teal-100 to-cyan-100 hover:from-teal-200 hover:to-cyan-200 border-2 border-teal-200 rounded-lg p-3 text-left transition-all duration-200 transform hover:scale-105 hover:shadow-md">undefined<br>undefined<div class="flex items-center">undefined<br>undefined<span class="text-2xl mr-2">🌊</span>undefined<br>undefined<span class="font-semibold text-teal-800">พี่เจ้ย</span>undefined<br>undefined</div>undefined<br>undefined</button>undefined<br>undefined<br>undefined<button onclick="selectEmployee('ลูกศร')" class="employee-btn bg-gradient-to-r from-red-100 to-pink-100 hover:from-red-200 hover:to-pink-200 border-2 border-red-200 rounded-lg p-3 text-left transition-all duration-200 transform hover:scale-105 hover:shadow-md">undefined<br>undefined<div class="flex items-center">undefined<br>undefined<span class="text-2xl mr-2">🏹</span>undefined<br>undefined<span class="font-semibold text-red-800">ลูกศร</span>undefined<br>undefined</div>undefined<br>undefined</button>undefined<br>undefined<br>undefined<button onclick="selectEmployee('พี่ปู')" class="employee-btn bg-gradient-to-r from-indigo-100 to-purple-100 hover:from-indigo-200 hover:to-purple-200 border-2 border-indigo-200 rounded-lg p-3 text-left transition-all duration-200 transform hover:scale-105 hover:shadow-md">undefined<br>undefined<div class="flex items-center">undefined<br>undefined<span class="text-2xl mr-2">🦀</span>undefined<br>undefined<span class="font-semibold text-indigo-800">พี่ปู</span>undefined<br>undefined</div>undefined<br>undefined</button>undefined<br>undefined<br>undefined<button onclick="selectEmployee('ป้าตุ้ม')" class="employee-btn bg-gradient-to-r from-yellow-100 to-orange-100 hover:from-yellow-200 hover:to-orange-200 border-2 border-yellow-200 rounded-lg p-3 text-left transition-all duration-200 transform hover:scale-105 hover:shadow-md">undefined<br>undefined<div class="flex items-center">undefined<br>undefined<span class="text-2xl mr-2">🌻</span>undefined<br>undefined<span class="font-semibold text-yellow-800">ป้าตุ้ม</span>undefined<br>undefined</div>undefined<br>undefined</button>undefined<br>undefined<br>undefined<button onclick="selectEmployee('พี่วัน')" class="employee-btn bg-gradient-to-r from-emerald-100 to-teal-100 hover:from-emerald-200 hover:to-teal-200 border-2 border-emerald-200 rounded-lg p-3 text-left transition-all duration-200 transform hover:scale-105 hover:shadow-md">undefined<br>undefined<div class="flex items-center">undefined<br>undefined<span class="text-2xl mr-2">🌟</span>undefined<br>undefined<span class="font-semibold text-emerald-800">พี่วัน</span>undefined<br>undefined</div>undefined<br>undefined</button>undefined<br>undefined<br>undefined<button onclick="selectEmployee('พี่หนูเล็ก')" class="employee-btn bg-gradient-to-r from-rose-100 to-pink-100 hover:from-rose-200 hover:to-pink-200 border-2 border-rose-200 rounded-lg p-3 text-left transition-all duration-200 transform hover:scale-105 hover:shadow-md">undefined<br>undefined<div class="flex items-center">undefined<br>undefined<span class="text-2xl mr-2">🐭</span>undefined<br>undefined<span class="font-semibold text-rose-800">พี่หนูเล็ก</span>undefined<br>undefined</div>undefined<br>undefined</button>undefined<br>undefined<br>undefined<button onclick="selectEmployee('โดนัท')" class="employee-btn bg-gradient-to-r from-amber-100 to-yellow-100 hover:from-amber-200 hover:to-yellow-200 border-2 border-amber-200 rounded-lg p-3 text-left transition-all duration-200 transform hover:scale-105 hover:shadow-md">undefined<br>undefined<div class="flex items-center">undefined<br>undefined<span class="text-2xl mr-2">🍩</span>undefined<br>undefined<span class="font-semibold text-amber-800">โดนัท</span>undefined<br>undefined</div>undefined<br>undefined</button>undefined<br>undefined<br>undefined<button onclick="selectEmployee('พี่ซัมเมอร์')" class="employee-btn bg-gradient-to-r from-sky-100 to-blue-100 hover:from-sky-200 hover:to-blue-200 border-2 border-sky-200 rounded-lg p-3 text-left transition-all duration-200 transform hover:scale-105 hover:shadow-md">undefined<br>undefined<div class="flex items-center">undefined<br>undefined<span class="text-2xl mr-2">☀️</span>undefined<br>undefined<span class="font-semibold text-sky-800">พี่ซัมเมอร์</span>undefined<br>undefined</div>undefined<br>undefined</button>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined<br>undefined<div class="mt-4 text-center">undefined<br>undefined<p class="text-sm text-gray-500 bg-blue-50 rounded-lg p-3 border border-blue-200">undefined<br> 💡 undefined<strong>เคล็ดลับ:</strong> คลิกที่ชื่อเพื่อเลือกอย่างรวดเร็ว หรือพิมพ์ชื่อในช่องด้านบนundefined<br>undefined</p>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined<br>undefined
          <!-- Manager Login -->undefined<br>undefined<div id="managerLogin" class="bg-white rounded-xl shadow-lg p-6 mb-8" style="display: none;">undefined<br>undefined<h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">undefined<br>undefined<span class="bg-orange-100 p-2 rounded-lg mr-3">👔</span>undefined<br> เข้าสู่ระบบผู้จัดการundefined<br>undefined</h2>undefined<br>undefined<div class="space-y-4">undefined<br>undefined<div>undefined<br>undefined<label class="block text-sm font-medium text-gray-700 mb-2">รหัสผ่าน</label>undefined<br>undefined<div class="relative">undefined<br>undefined<input type="password" id="managerPassword" placeholder="กรอกรหัสผ่านผู้จัดการ" class="w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500" onkeypress="handleEnterKey(event, 'manager')">undefined<br>undefined<button type="button" onclick="togglePassword('managerPassword')" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700">undefined<br>undefined<span id="managerPasswordToggle">👁️</span>undefined<br>undefined</button>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined<button onclick="managerLogin()" class="w-full bg-orange-600 hover:bg-orange-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200">undefined<br> เข้าสู่ระบบundefined<br>undefined</button>undefined<br>undefined</div>undefined<br>undefined<div class="mt-4 p-3 bg-orange-50 rounded-lg">undefined<br>undefined<p class="text-sm text-orange-700">กรุณาติดต่อผู้ดูแลระบบเพื่อขอรหัสผ่าน</p>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined<br>undefined
          <!-- Admin Login -->undefined<br>undefined<div id="adminLogin" class="bg-white rounded-xl shadow-lg p-6 mb-8" style="display: none;">undefined<br>undefined<h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">undefined<br>undefined<span class="bg-purple-100 p-2 rounded-lg mr-3">⚙️</span>undefined<br> เข้าสู่ระบบผู้ดูแลระบบundefined<br>undefined</h2>undefined<br>undefined<div class="space-y-4">undefined<br>undefined<div>undefined<br>undefined<label class="block text-sm font-medium text-gray-700 mb-2">รหัสผ่าน</label>undefined<br>undefined<input type="password" id="adminPassword" placeholder="กรอกรหัสผ่านผู้ดูแลระบบ" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" onkeypress="handleEnterKey(event, 'admin')">undefined<br>undefined</div>undefined<br>undefined<button onclick="adminLogin()" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200">undefined<br> เข้าสู่ระบบundefined<br>undefined</button>undefined<br>undefined</div>undefined<br>undefined<div class="mt-4 p-3 bg-purple-50 rounded-lg">undefined<br>undefined<p class="text-sm text-purple-700">รหัสผ่าน: admin123</p>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined<br>undefined
          <!-- Employee Dashboard -->undefined<br>undefined<div id="employeeDashboard" class="space-y-6" style="display: none;">undefined<br>undefined<div class="bg-white rounded-xl shadow-lg p-6">undefined<br>undefined<div class="flex justify-between items-center mb-6">undefined<br>undefined<h2 class="text-2xl font-bold text-gray-800">แดชบอร์ดพนักงาน</h2>undefined<br>undefined<div class="flex items-center space-x-4">undefined<br>undefined<span id="currentEmployee" class="text-gray-600"></span>undefined<br>undefined<button onclick="logout()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg">ออกจากระบบ</button>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined<br>undefined
              <!-- Leave Balance -->undefined<br>undefined<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">undefined<br>undefined<div class="balance-card bg-gradient-to-br from-green-50 to-emerald-100 p-5 rounded-xl border-2 border-green-200 shadow-lg hover:shadow-xl">undefined<br>undefined<div class="flex items-center justify-between mb-3">undefined<br>undefined<div class="text-4xl emoji-float">🏖️</div>undefined<br>undefined<div class="text-green-600 font-bold text-xs bg-green-200 px-2 py-1 rounded-full">VACATION</div>undefined<br>undefined</div>undefined<br>undefined<h3 class="font-semibold text-green-800 text-sm mb-2">วันลาพักผ่อนคงเหลือ</h3>undefined<br>undefined<div class="flex items-center">undefined<br>undefined<p class="text-3xl font-bold text-green-600" id="vacationBalance">15</p>undefined<br>undefined<span class="text-green-500 ml-2 text-lg">วัน ✨</span>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined<div class="balance-card bg-gradient-to-br from-blue-50 to-sky-100 p-5 rounded-xl border-2 border-blue-200 shadow-lg hover:shadow-xl">undefined<br>undefined<div class="flex items-center justify-between mb-3">undefined<br>undefined<div class="text-4xl emoji-float" style="animation-delay: 0.5s">🤒</div>undefined<br>undefined<div class="text-blue-600 font-bold text-xs bg-blue-200 px-2 py-1 rounded-full">SICK</div>undefined<br>undefined</div>undefined<br>undefined<h3 class="font-semibold text-blue-800 text-sm mb-2">วันลาป่วยคงเหลือ</h3>undefined<br>undefined<div class="flex items-center">undefined<br>undefined<p class="text-3xl font-bold text-blue-600" id="sickBalance">30</p>undefined<br>undefined<span class="text-blue-500 ml-2 text-lg">วัน 💊</span>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined<div class="balance-card bg-gradient-to-br from-orange-50 to-amber-100 p-5 rounded-xl border-2 border-orange-200 shadow-lg hover:shadow-xl">undefined<br>undefined<div class="flex items-center justify-between mb-3">undefined<br>undefined<div class="text-4xl emoji-float" style="animation-delay: 1s">🎉</div>undefined<br>undefined<div class="text-orange-600 font-bold text-xs bg-orange-200 px-2 py-1 rounded-full">ANNUAL</div>undefined<br>undefined</div>undefined<br>undefined<h3 class="font-semibold text-orange-800 text-sm mb-2">วันหยุดประจำปีคงเหลือ</h3>undefined<br>undefined<div class="flex items-center">undefined<br>undefined<p class="text-3xl font-bold text-orange-600" id="annualBalance">19</p>undefined<br>undefined<span class="text-orange-500 ml-2 text-lg">วัน 🎊</span>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined<div class="balance-card bg-gradient-to-br from-purple-50 to-violet-100 p-5 rounded-xl border-2 border-purple-200 shadow-lg hover:shadow-xl">undefined<br>undefined<div class="flex items-center justify-between mb-3">undefined<br>undefined<div class="text-4xl emoji-float" style="animation-delay: 1.5s">⚡</div>undefined<br>undefined<div class="text-purple-600 font-bold text-xs bg-purple-200 px-2 py-1 rounded-full">EXTRA</div>undefined<br>undefined</div>undefined<br>undefined<h3 class="font-semibold text-purple-800 text-sm mb-2">วันหยุดชดเชยคงเหลือ</h3>undefined<br>undefined<div class="flex items-center">undefined<br>undefined<p class="text-3xl font-bold text-purple-600" id="compensatoryBalance">0</p>undefined<br>undefined<span class="text-purple-500 ml-2 text-lg">วัน 🚀</span>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined<br>undefined
              <!-- Leave Request Form -->undefined<br>undefined<div class="bg-gray-50 p-6 rounded-lg mb-6">undefined<br>undefined<h3 class="text-lg font-semibold mb-4">ยื่นคำขอลาหยุดงาน</h3>undefined<br>undefined<div class="grid grid-cols-1 md:grid-cols-2 gap-4">undefined<br>undefined<div>undefined<br>undefined<label class="block text-sm font-medium text-gray-700 mb-2">ประเภทการลา</label>undefined<br>undefined<select id="leaveType" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="handleLeaveTypeChange()">undefined<br>undefined<option value="vacation">ลาพักผ่อน</option>undefined<br>undefined<option value="sick">ลาป่วย</option>undefined<br>undefined<option value="annual">วันหยุดประจำปี</option>undefined<br>undefined<option value="compensatory">วันหยุดชดเชย</option>undefined<br>undefined</select>undefined<br>undefined</div>undefined<br>undefined<div>undefined<br>undefined<label class="block text-sm font-medium text-gray-700 mb-2">จำนวนวัน</label>undefined<br>undefined<input type="number" id="leaveDays" min="1" max="30" value="1" class="w-full px-4 py-3 border border-gray-300 rounded-lg bg-gray-100" readonly>undefined<br>undefined</div>undefined<br>undefined<div>undefined<br>undefined<label class="block text-sm font-medium text-gray-700 mb-2">วันที่เริ่มต้น</label>undefined<br>undefined<input type="date" id="startDate" class="w-full px-4 py-3 border border-gray-300 rounded-lg">undefined<br>undefined</div>undefined<br>undefined<div>undefined<br>undefined<label class="block text-sm font-medium text-gray-700 mb-2">วันที่สิ้นสุด</label>undefined<br>undefined<input type="date" id="endDate" class="w-full px-4 py-3 border border-gray-300 rounded-lg">undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined<div class="mt-4">undefined<br>undefined<label class="block text-sm font-medium text-gray-700 mb-2">เหตุผล</label>undefined<br>undefined<textarea id="leaveReason" rows="3" placeholder="กรอกเหตุผลในการลา" class="w-full px-4 py-3 border border-gray-300 rounded-lg"></textarea>undefined<br>undefined</div>undefined<br>undefined<div id="medicalCertificateSection" class="mt-4" style="display: none;">undefined<br>undefined<label class="block text-sm font-medium text-gray-700 mb-2">อัพโหลดใบรับรองแพทย์</label>undefined<br>undefined<div class="relative">undefined<br>undefined<input type="file" id="medicalCertificate" accept="image/*,.pdf" class="hidden">undefined<br>undefined<div onclick="document.getElementById('medicalCertificate').click()" class="cursor-pointer border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 hover:bg-blue-50 transition-colors">undefined<br>undefined<div class="flex flex-col items-center">undefined<br>undefined<svg class="w-12 h-12 text-gray-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">undefined<br>undefined<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>undefined<br>undefined</svg>undefined<br>undefined<p class="text-gray-600 font-medium">คลิกเพื่อเลือกไฟล์</p>undefined<br>undefined<p class="text-sm text-gray-500 mt-1">หรือลากไฟล์มาวางที่นี่</p>undefined<br>undefined<p class="text-xs text-gray-400 mt-2">รองรับไฟล์: JPG, PNG, PDF (ขนาดไม่เกิน 5MB)</p>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined<div id="filePreview" class="mt-2 hidden">undefined<br>undefined<div class="flex items-center p-3 bg-green-50 border border-green-200 rounded-lg">undefined<br>undefined<svg class="w-5 h-5 text-green-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">undefined<br>undefined<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>undefined<br>undefined</svg>undefined<br>undefined<span id="fileName" class="text-green-800 font-medium"></span>undefined<br>undefined<button type="button" onclick="clearFile()" class="ml-auto text-red-600 hover:text-red-800">undefined<br>undefined<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">undefined<br>undefined<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>undefined<br>undefined</svg>undefined<br>undefined</button>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined<div class="mt-4">undefined<br>undefined<button onclick="submitLeaveRequest()" class="w-full bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg">ยื่นคำขอลา</button>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined<br>undefined
              <!-- Action Buttons -->undefined<br>undefined<div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">undefined<br>undefined<div class="bg-gray-50 p-4 rounded-lg">undefined<br>undefined<button onclick="showCalendarModal()" class="w-full bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg flex items-center justify-center">undefined<br>undefined<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">undefined<br>undefined<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 002 2z"></path>undefined<br>undefined</svg>undefined<br> ดูปฏิทินการลาundefined<br>undefined</button>undefined<br>undefined</div>undefined<br>undefined<div class="bg-gray-50 p-4 rounded-lg">undefined<br>undefined<button onclick="showCompensatoryWorkModal()" class="w-full bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg flex items-center justify-center">undefined<br>undefined<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">undefined<br>undefined<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>undefined<br>undefined</svg>undefined<br> แจ้งมาทำงานในวันหยุดundefined<br>undefined</button>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined<br>undefined
              <!-- Compensatory Work Modal -->undefined<br>undefined<div id="compensatoryWorkModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" style="display: none;">undefined<br>undefined<div class="bg-white rounded-xl p-6 w-full max-w-md mx-4">undefined<br>undefined<div class="flex justify-between items-center mb-4">undefined<br>undefined<h3 class="text-lg font-semibold text-purple-800">แจ้งมาทำงานในวันหยุด</h3>undefined<br>undefined<button onclick="closeCompensatoryWorkModal()" class="text-gray-500 hover:text-gray-700">undefined<br>undefined<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">undefined<br>undefined<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>undefined<br>undefined</svg>undefined<br>undefined</button>undefined<br>undefined</div>undefined<br>undefined<div class="space-y-4">undefined<br>undefined<div>undefined<br>undefined<label class="block text-sm font-medium text-gray-700 mb-2">วันที่เริ่มต้น</label>undefined<br>undefined<input type="date" id="compensatoryWorkStartDate" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculateCompensatoryEndDate()">undefined<br>undefined</div>undefined<br>undefined<div>undefined<br>undefined<label class="block text-sm font-medium text-gray-700 mb-2">วันที่สิ้นสุด</label>undefined<br>undefined<input type="date" id="compensatoryWorkEndDate" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculateCompensatoryDays()">undefined<br>undefined</div>undefined<br>undefined<div>undefined<br>undefined<label class="block text-sm font-medium text-gray-700 mb-2">จำนวนวัน</label>undefined<br>undefined<input type="number" id="compensatoryWorkDays" min="1" max="30" value="1" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculateCompensatoryEndDateFromDays()">undefined<br>undefined</div>undefined<br>undefined<div>undefined<br>undefined<label class="block text-sm font-medium text-gray-700 mb-2">เหตุผล/รายละเอียดงาน</label>undefined<br>undefined<textarea id="compensatoryWorkReason" rows="3" placeholder="กรอกเหตุผลหรือรายละเอียดงานที่ต้องมาทำ" class="w-full px-4 py-3 border border-gray-300 rounded-lg"></textarea>undefined<br>undefined</div>undefined<br>undefined<div class="flex space-x-3">undefined<br>undefined<button onclick="submitCompensatoryWorkRequest()" class="flex-1 bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg">undefined<br> ยื่นคำขอundefined<br>undefined</button>undefined<br>undefined<button onclick="closeCompensatoryWorkModal()" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 px-4 py-2 rounded-lg">undefined<br> ยกเลิกundefined<br>undefined</button>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined<br>undefined
              <!-- Calendar Modal -->undefined<br>undefined<div id="calendarModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" style="display: none;">undefined<br>undefined<div class="bg-white rounded-xl p-6 w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto">undefined<br>undefined<div class="flex justify-between items-center mb-4">undefined<br>undefined<h3 class="text-lg font-semibold">ปฏิทินการลา</h3>undefined<br>undefined<button onclick="closeCalendarModal()" class="text-gray-500 hover:text-gray-700">undefined<br>undefined<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">undefined<br>undefined<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>undefined<br>undefined</svg>undefined<br>undefined</button>undefined<br>undefined</div>undefined<br>undefined<div id="employeeCalendar" class="grid grid-cols-7 gap-2 text-center">undefined<br>undefined
                    <!-- Calendar will be generated here -->undefined<br>undefined
                  </div>undefined<br>undefined<div class="mt-4 flex flex-wrap gap-4 text-sm">undefined<br>undefined<div class="flex items-center">undefined<div class="w-4 h-4 bg-red-200 rounded mr-2"></div>วันที่ล็อคundefined</div>undefined<br>undefined<div class="flex items-center">undefined<div class="w-4 h-4 bg-yellow-200 rounded mr-2"></div>มีคนลา 1-2 คนundefined</div>undefined<br>undefined<div class="flex items-center">undefined<div class="w-4 h-4 bg-orange-300 rounded mr-2"></div>มีคนลา 3 คน (เต็ม)undefined</div>undefined<br>undefined<div class="flex items-center">undefined<div class="w-4 h-4 bg-blue-200 rounded mr-2"></div>วันลาของคุณundefined</div>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined<br>undefined
              <!-- Leave History -->undefined<br>undefined<div>undefined<br>undefined<h3 class="text-lg font-semibold mb-4">ประวัติการลา</h3>undefined<br>undefined<div id="leaveHistory" class="space-y-3">undefined<br>undefined
                  <!-- Leave history will be populated here -->undefined<br>undefined
                </div>undefined<br>undefined</div>undefined<br>undefined
            </div>undefined<br>undefined</div>undefined<br>undefined<br>undefined
          <!-- Manager Dashboard -->undefined<br>undefined<div id="managerDashboard" class="space-y-6" style="display: none;">undefined<br>undefined<div class="bg-white rounded-xl shadow-lg p-6">undefined<br>undefined<div class="flex justify-between items-center mb-6">undefined<br>undefined<h2 class="text-2xl font-bold text-gray-800">แดชบอร์ดผู้จัดการ</h2>undefined<br>undefined<button onclick="logout()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg">ออกจากระบบ</button>undefined<br>undefined</div>undefined<br>undefined<br>undefined
              <!-- Pending Requests (Priority 1) -->undefined<br>undefined<div class="mb-6">undefined<br>undefined<h3 class="text-lg font-semibold mb-4 flex items-center">undefined<br>undefined<span class="bg-yellow-100 p-2 rounded-lg mr-3">⏳</span>undefined<br> คำขอที่รออนุมัติundefined<br>undefined</h3>undefined<br>undefined<div id="pendingRequests" class="space-y-3">undefined<br>undefined
                  <!-- Pending requests will be populated here -->undefined<br>undefined
                </div>undefined<br>undefined</div>undefined<br>undefined<br>undefined
              <!-- Calendar Management -->undefined<br>undefined<div class="mb-6">undefined<br>undefined<h3 class="text-lg font-semibold mb-4">จัดการปฏิทินและวันลา</h3>undefined<br>undefined<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">undefined<br>undefined
                  <!-- Lock Calendar -->undefined<br>undefined<div class="bg-gray-50 p-4 rounded-lg">undefined<br>undefined<h4 class="font-semibold mb-3">ล็อคปฏิทิน</h4>undefined<br>undefined<div class="space-y-3">undefined<br>undefined<div>undefined<br>undefined<label class="block text-sm font-medium text-gray-700 mb-1">วันที่เริ่มต้น</label>undefined<br>undefined<input type="date" id="lockStartDate" class="w-full px-3 py-2 border border-gray-300 rounded">undefined<br>undefined</div>undefined<br>undefined<div>undefined<br>undefined<label class="block text-sm font-medium text-gray-700 mb-1">วันที่สิ้นสุด</label>undefined<br>undefined<input type="date" id="lockEndDate" class="w-full px-3 py-2 border border-gray-300 rounded">undefined<br>undefined</div>undefined<br>undefined<div>undefined<br>undefined<label class="block text-sm font-medium text-gray-700 mb-1">เหตุผล</label>undefined<br>undefined<input type="text" id="lockReason" placeholder="เช่น วันสำคัญของบริษัท" class="w-full px-3 py-2 border border-gray-300 rounded">undefined<br>undefined</div>undefined<br>undefined<button onclick="lockCalendar()" class="w-full bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded">ล็อคปฏิทิน</button>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined<br>undefined
                  <!-- Adjust Leave Days -->undefined<br>undefined<div class="bg-gray-50 p-4 rounded-lg">undefined<br>undefined<h4 class="font-semibold mb-3">ปรับวันลา</h4>undefined<br>undefined<div class="space-y-3">undefined<br>undefined<div>undefined<br>undefined<label class="block text-sm font-medium text-gray-700 mb-1">เลือกพนักงาน</label>undefined<br>undefined<select id="selectEmployee" class="w-full px-3 py-2 border border-gray-300 rounded">undefined<br>undefined<option value="">-- เลือกพนักงาน --</option>undefined<br>undefined</select>undefined<br>undefined</div>undefined<br>undefined<div id="individualAdjustment" style="display: none;">undefined<br>undefined<div class="space-y-2">undefined<br>undefined<div>undefined<br>undefined<label class="block text-sm font-medium text-gray-700 mb-1">ลาพักผ่อน</label>undefined<br>undefined<input type="number" id="adjustIndividualVacation" min="0" max="30" class="w-full px-3 py-2 border border-gray-300 rounded">undefined<br>undefined</div>undefined<br>undefined<div>undefined<br>undefined<label class="block text-sm font-medium text-gray-700 mb-1">ลาป่วย</label>undefined<br>undefined<input type="number" id="adjustIndividualSick" min="0" max="60" class="w-full px-3 py-2 border border-gray-300 rounded">undefined<br>undefined</div>undefined<br>undefined<div>undefined<br>undefined<label class="block text-sm font-medium text-gray-700 mb-1">วันหยุดประจำปี</label>undefined<br>undefined<input type="number" id="adjustIndividualAnnual" min="0" max="30" class="w-full px-3 py-2 border border-gray-300 rounded">undefined<br>undefined</div>undefined<br>undefined<div>undefined<br>undefined<label class="block text-sm font-medium text-gray-700 mb-1">วันหยุดชดเชย</label>undefined<br>undefined<input type="number" id="adjustIndividualCompensatory" min="0" max="20" class="w-full px-3 py-2 border border-gray-300 rounded">undefined<br>undefined</div>undefined<br>undefined<button onclick="adjustIndividualLeave()" class="w-full bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded">ปรับวันลา</button>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined
                      <hr class="my-3">undefined<br>undefined<div>undefined<br>undefined<h5 class="font-medium mb-2">ปรับทั้งหมด</h5>undefined<br>undefined<div class="grid grid-cols-2 gap-2">undefined<br>undefined<div>undefined<br>undefined<label class="block text-xs text-gray-600 mb-1">ลาพักผ่อน</label>undefined<br>undefined<input type="number" id="adjustVacation" value="15" min="0" max="30" class="w-full px-2 py-1 border border-gray-300 rounded text-sm">undefined<br>undefined</div>undefined<br>undefined<div>undefined<br>undefined<label class="block text-xs text-gray-600 mb-1">ลาป่วย</label>undefined<br>undefined<input type="number" id="adjustSick" value="30" min="0" max="60" class="w-full px-2 py-1 border border-gray-300 rounded text-sm">undefined<br>undefined</div>undefined<br>undefined<div>undefined<br>undefined<label class="block text-xs text-gray-600 mb-1">วันหยุดประจำปี</label>undefined<br>undefined<input type="number" id="adjustAnnual" value="19" min="0" max="30" class="w-full px-2 py-1 border border-gray-300 rounded text-sm">undefined<br>undefined</div>undefined<br>undefined<div>undefined<br>undefined<label class="block text-xs text-gray-600 mb-1">วันหยุดชดเชย</label>undefined<br>undefined<input type="number" id="adjustCompensatory" value="0" min="0" max="20" class="w-full px-2 py-1 border border-gray-300 rounded text-sm">undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined<button onclick="adjustAllLeaves()" class="w-full mt-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded">ปรับวันลาทั้งหมด</button>undefined<br>undefined</div>undefined<br>undefined
                    </div>undefined<br>undefined</div>undefined<br>undefined
                </div>undefined<br>undefined<br>undefined
                <!-- Locked Dates Display -->undefined<br>undefined<div class="mt-4">undefined<br>undefined<h4 class="font-semibold mb-2">วันที่ถูกล็อค</h4>undefined<br>undefined<div id="lockedDates" class="space-y-2">undefined<br>undefined
                    <!-- Locked dates will be displayed here -->undefined<br>undefined
                  </div>undefined<br>undefined</div>undefined<br>undefined
              </div>undefined<br>undefined<br>undefined
              <!-- Leave Calendar -->undefined<br>undefined<div class="mb-6">undefined<br>undefined<h3 class="text-lg font-semibold mb-4">ปฏิทินการลา</h3>undefined<br>undefined<div class="bg-white border rounded-lg p-4">undefined<br>undefined<div id="leaveCalendar" class="grid grid-cols-7 gap-2 text-center">undefined<br>undefined
                    <!-- Calendar will be generated here -->undefined<br>undefined
                  </div>undefined<br>undefined<div class="mt-4 flex flex-wrap gap-4 text-sm">undefined<br>undefined<div class="flex items-center">undefined<div class="w-4 h-4 bg-red-200 rounded mr-2"></div>วันที่ล็อคundefined</div>undefined<br>undefined<div class="flex items-center">undefined<div class="w-4 h-4 bg-yellow-200 rounded mr-2"></div>มีคนลา 1-2 คนundefined</div>undefined<br>undefined<div class="flex items-center">undefined<div class="w-4 h-4 bg-orange-300 rounded mr-2"></div>มีคนลา 3 คน (เต็ม)undefined</div>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined<br>undefined
              <!-- All Leave Requests -->undefined<br>undefined<div>undefined<br>undefined<h3 class="text-lg font-semibold mb-4">คำขอทั้งหมด</h3>undefined<br>undefined<div id="allRequests" class="space-y-3">undefined<br>undefined
                  <!-- All requests will be populated here -->undefined<br>undefined
                </div>undefined<br>undefined</div>undefined<br>undefined
            </div>undefined<br>undefined</div>undefined<br>undefined<br>undefined
          <!-- Admin Dashboard -->undefined<br>undefined<div id="adminDashboard" class="space-y-6" style="display: none;">undefined<br>undefined<div class="bg-white rounded-xl shadow-lg p-6">undefined<br>undefined<div class="flex justify-between items-center mb-6">undefined<br>undefined<h2 class="text-2xl font-bold text-gray-800">แดชบอร์ดผู้ดูแลระบบ</h2>undefined<br>undefined<button onclick="logout()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg">ออกจากระบบ</button>undefined<br>undefined</div>undefined<br>undefined<br>undefined
              <!-- Google Sheets Integration -->undefined<br>undefined<div class="mb-6 bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-xl border-2 border-green-200">undefined<br>undefined<h3 class="text-lg font-semibold mb-4 flex items-center">undefined<br>undefined<span class="bg-green-100 p-2 rounded-lg mr-3">📊</span>undefined<br> Google Sheets Integrationundefined<br>undefined</h3>undefined<br>undefined<br>undefined<div class="grid grid-cols-1 md:grid-cols-2 gap-6">undefined<br>undefined
                  <!-- Setup Section -->undefined<br>undefined<div class="bg-white p-4 rounded-lg border border-green-200">undefined<br>undefined<h4 class="font-semibold mb-3 text-green-800">🔧 ตั้งค่าการเชื่อมต่อ</h4>undefined<br>undefined<div class="space-y-3">undefined<br>undefined<div>undefined<br>undefined<label class="block text-sm font-medium text-gray-700 mb-1">Google Sheets URL</label>undefined<br>undefined<input type="url" id="googleSheetsUrl" placeholder="https://docs.google.com/spreadsheets/d/..." class="w-full px-3 py-2 border border-gray-300 rounded text-sm">undefined<br>undefined<p class="text-xs text-gray-500 mt-1">วางลิงก์ Google Sheets ที่ต้องการบันทึกข้อมูล</p>undefined<br>undefined</div>undefined<br>undefined<div>undefined<br>undefined<label class="block text-sm font-medium text-gray-700 mb-1">API Key (ถ้ามี)</label>undefined<br>undefined<input type="password" id="googleApiKey" placeholder="ใส่ API Key ถ้าต้องการ" class="w-full px-3 py-2 border border-gray-300 rounded text-sm">undefined<br>undefined<p class="text-xs text-gray-500 mt-1">ไม่บังคับ - สำหรับการเชื่อมต่อขั้นสูง</p>undefined<br>undefined</div>undefined<br>undefined<button onclick="testGoogleConnection()" class="w-full bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded text-sm">undefined<br> ทดสอบการเชื่อมต่อundefined<br>undefined</button>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined<br>undefined
                  <!-- Export Section -->undefined<br>undefined<div class="bg-white p-4 rounded-lg border border-blue-200">undefined<br>undefined<h4 class="font-semibold mb-3 text-blue-800">📤 ส่งออกข้อมูล</h4>undefined<br>undefined<div class="space-y-2">undefined<br>undefined<button onclick="exportToGoogleSheets('all')" class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded text-sm flex items-center justify-center">undefined<br>undefined<svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">undefined<br>undefined<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>undefined<br>undefined</svg>undefined<br> ส่งข้อมูลทั้งหมดundefined<br>undefined</button>undefined<br>undefined<button onclick="exportToGoogleSheets('employees')" class="w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded text-sm">undefined<br> ข้อมูลพนักงานundefined<br>undefined</button>undefined<br>undefined<button onclick="exportToGoogleSheets('leaves')" class="w-full bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded text-sm">undefined<br> ประวัติการลาundefined<br>undefined</button>undefined<br>undefined<button onclick="exportToGoogleSheets('balances')" class="w-full bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded text-sm">undefined<br> ยอดวันลาคงเหลือundefined<br>undefined</button>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined
                </div>undefined<br>undefined<br>undefined
                <!-- Auto Backup Settings -->undefined<br>undefined<div class="mt-4 bg-white p-4 rounded-lg border border-gray-200">undefined<br>undefined<h4 class="font-semibold mb-3">⚡ การสำรองข้อมูลอัตโนมัติ</h4>undefined<br>undefined<div class="flex items-center space-x-4">undefined<br>undefined<label class="flex items-center">undefined<br>undefined<input type="checkbox" id="autoBackup" class="mr-2" onchange="toggleAutoBackup()">undefined<br>undefined<span class="text-sm">เปิดการสำรองข้อมูลอัตโนมัติ</span>undefined<br>undefined</label>undefined<br>undefined<select id="backupInterval" class="px-3 py-1 border border-gray-300 rounded text-sm" disabled>undefined<br>undefined<option value="daily">ทุกวัน</option>undefined<br>undefined<option value="weekly">ทุกสัปดาห์</option>undefined<br>undefined<option value="monthly">ทุกเดือน</option>undefined<br>undefined</select>undefined<br>undefined</div>undefined<br>undefined<p class="text-xs text-gray-500 mt-2">เมื่อเปิดใช้งาน ระบบจะสำรองข้อมูลไปยัง Google Sheets โดยอัตโนมัติ</p>undefined<br>undefined</div>undefined<br>undefined<br>undefined
                <!-- Backup Status -->undefined<br>undefined<div class="mt-4 bg-gray-50 p-4 rounded-lg">undefined<br>undefined<h4 class="font-semibold mb-2">📋 สถานะการสำรองข้อมูล</h4>undefined<br>undefined<div id="backupStatus" class="text-sm text-gray-600">undefined<br> ยังไม่มีการสำรองข้อมูลundefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined
              </div>undefined<br>undefined<br>undefined
              <!-- Employee Management -->undefined<br>undefined<div class="mb-6">undefined<br>undefined<h3 class="text-lg font-semibold mb-4">จัดการพนักงาน</h3>undefined<br>undefined<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="employeeList">undefined<br>undefined
                  <!-- Employee cards will be populated here -->undefined<br>undefined
                </div>undefined<br>undefined</div>undefined<br>undefined<br>undefined
              <!-- System Statistics -->undefined<br>undefined<div class="grid grid-cols-1 md:grid-cols-3 gap-4">undefined<br>undefined<div class="bg-blue-50 p-4 rounded-lg">undefined<br>undefined<h3 class="font-semibold text-blue-800">คำขอรออนุมัติ</h3>undefined<br>undefined<p class="text-2xl font-bold text-blue-600" id="pendingCount">0</p>undefined<br>undefined</div>undefined<br>undefined<div class="bg-green-50 p-4 rounded-lg">undefined<br>undefined<h3 class="font-semibold text-green-800">คำขอที่อนุมัติ</h3>undefined<br>undefined<p class="text-2xl font-bold text-green-600" id="approvedCount">0</p>undefined<br>undefined</div>undefined<br>undefined<div class="bg-red-50 p-4 rounded-lg">undefined<br>undefined<h3 class="font-semibold text-red-800">คำขอที่ปฏิเสธ</h3>undefined<br>undefined<p class="text-2xl font-bold text-red-600" id="rejectedCount">0</p>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined
            </div>undefined<br>undefined</div>undefined<br>undefined
        </div>undefined<br>undefined<br>undefined<script>
          undefined < br > // Data storageundefined<br>        let currentUser = null;undefined<br>        let currentRole = null;undefined<br>undefined<br>        const employees = [undefined<br>            'แม่เปิ้ล', 'น้าจอส', 'น้าปุ้ย', 'แน็ตตี้', 'เกด', 'พี่เจ้ย',undefined<br>            'ลูกศร', 'พี่ปู', 'ป้าตุ้ม', 'พี่วัน', 'พี่หนูเล็ก', 'โดนัท', 'พี่ซัมเมอร์'undefined<br>        ];undefined<br>undefined<br>        let leaveRequests = JSON.parse(localStorage.getItem('leaveRequests')) || [];undefined<br>        let compensatoryWorkRequests = JSON.parse(localStorage.getItem('compensatoryWorkRequests')) || [];undefined<br>        let employeeBalances = JSON.parse(localStorage.getItem('employeeBalances')) || {};undefined<br>undefined<br>        // Initialize employee balancesundefined<br>        employees.forEach(emp => {undefined<br>            if (!employeeBalances[emp]) {undefined<br>                employeeBalances[emp] = {undefined<br>                    vacation: 15,undefined<br>                    sick: 30,undefined<br>                    annual: 19,undefined<br>                    compensatory: 0undefined<br>                };undefined<br>            }undefined<br>        });undefined<br>undefined<br>        let lockedDates = JSON.parse(localStorage.getItem('lockedDates')) || [];undefined<br>        let notifications = JSON.parse(localStorage.getItem('notifications')) || [];undefined<br>undefined<br>        // Password toggle functionundefined<br>        function togglePassword(inputId) {undefined<br>            const input = document.getElementById(inputId);undefined<br>            const toggle = document.getElementById(inputId + 'Toggle');undefined<br>undefined<br>            if (input.type === 'password') {undefined<br>                input.type = 'text';undefined<br>                toggle.textContent = '🙈';undefined<br>            } else {undefined<br>                input.type = 'password';undefined<br>                toggle.textContent = '👁️';undefined<br>            }undefined<br>        }undefined<br>undefined<br>        // Handle Enter key pressundefined<br>        function handleEnterKey(event, type) {undefined<br>            if (event.key === 'Enter') {undefined<br>                if (type === 'employee') {undefined<br>                    employeeLogin();undefined<br>                } else if (type === 'manager') {undefined<br>                    managerLogin();undefined<br>                } else if (type === 'admin') {undefined<br>                    adminLogin();undefined<br>                }undefined<br>            }undefined<br>        }undefined<br>undefined<br>        // Handle leave type changeundefined<br>        function handleLeaveTypeChange() {undefined<br>            const leaveType = document.getElementById('leaveType').value;undefined<br>            const medicalSection = document.getElementById('medicalCertificateSection');undefined<br>undefined<br>            if (leaveType === 'sick') {undefined<br>                medicalSection.style.display = 'block';undefined<br>            } else {undefined<br>                medicalSection.style.display = 'none';undefined<br>            }undefined<br>        }undefined<br>undefined<br>        // Tab switchingundefined<br>        function switchTab(tab) {undefined<br>            // Hide all login formsundefined<br>            document.getElementById('employeeLogin').style.display = 'none';undefined<br>            document.getElementById('managerLogin').style.display = 'none';undefined<br>            document.getElementById('adminLogin').style.display = 'none';undefined<br>undefined<br>            // Hide all dashboardsundefined<br>            document.getElementById('employeeDashboard').style.display = 'none';undefined<br>            document.getElementById('managerDashboard').style.display = 'none';undefined<br>            document.getElementById('adminDashboard').style.display = 'none';undefined<br>undefined<br>            // Reset tab stylesundefined<br>            document.querySelectorAll('#navigationTabs button').forEach(btn => {undefined<br>                btn.className = 'flex-1 py-3 px-4 rounded-lg font-medium transition-colors text-gray-600 hover:bg-gray-100';undefined<br>            });undefined<br>undefined<br>            // Show selected tabundefined<br>            if (tab === 'employee') {undefined<br>                document.getElementById('employeeLogin').style.display = 'block';undefined<br>                document.getElementById('employeeTab').className = 'flex-1 py-3 px-4 rounded-lg font-medium transition-colors bg-blue-600 text-white';undefined<br>            } else if (tab === 'manager') {undefined<br>                document.getElementById('managerLogin').style.display = 'block';undefined<br>                document.getElementById('managerTab').className = 'flex-1 py-3 px-4 rounded-lg font-medium transition-colors bg-orange-600 text-white';undefined<br>            } else if (tab === 'admin') {undefined<br>                document.getElementById('adminLogin').style.display = 'block';undefined<br>                document.getElementById('adminTab').className = 'flex-1 py-3 px-4 rounded-lg font-medium transition-colors bg-purple-600 text-white';undefined<br>            }undefined<br>        }undefined<br>undefined<br>        // Login functionsundefined<br>        function employeeLogin() {undefined<br>            const username = document.getElementById('employeeUsername').value.trim();undefined<br>            if (employees.includes(username)) {undefined<br>                currentUser = username;undefined<br>                currentRole = 'employee';undefined<br>                showEmployeeDashboard();undefined<br>            } else {undefined<br>                alert('ไม่พบชื่อผู้ใช้นี้ในระบบ');undefined<br>            }undefined<br>        }undefined<br>undefined<br>        function managerLogin() {undefined<br>            const password = document.getElementById('managerPassword').value;undefined<br>            if (password === 'manager123') {undefined<br>                currentUser = 'Manager';undefined<br>                currentRole = 'manager';undefined<br>                showManagerDashboard();undefined<br>            } else {undefined<br>                showFunnyErrorPopup('รหัสผิดจ้า!! 😅', '🤦‍♂️ ลองใหม่นะคะ เผื่อพิมพ์ผิด!');undefined<br>            }undefined<br>        }undefined<br>undefined<br>        function adminLogin() {undefined<br>            const password = document.getElementById('adminPassword').value;undefined<br>            if (password === 'admin123') {undefined<br>                currentUser = 'Admin';undefined<br>                currentRole = 'admin';undefined<br>                showAdminDashboard();undefined<br>            } else {undefined<br>                showFunnyErrorPopup('รหัสผิดจ้า!! 🤪', '🙈 อย่าลืมว่าเป็น admin123 นะ!');undefined<br>            }undefined<br>        }undefined<br>undefined<br>        // Dashboard functionsundefined<br>        function showEmployeeDashboard() {undefined<br>            document.getElementById('navigationTabs').style.display = 'none';undefined<br>            document.getElementById('employeeLogin').style.display = 'none';undefined<br>            document.getElementById('employeeDashboard').style.display = 'block';undefined<br>            document.getElementById('currentEmployee').textContent = `สวัสดี, ${currentUser}`;undefined<br>undefined<br>            // Update balancesundefined<br>            const balance = employeeBalances[currentUser];undefined<br>            document.getElementById('vacationBalance').textContent = balance.vacation;undefined<br>            document.getElementById('sickBalance').textContent = balance.sick;undefined<br>            document.getElementById('annualBalance').textContent = balance.annual;undefined<br>            document.getElementById('compensatoryBalance').textContent = balance.compensatory;undefined<br>undefined<br>            // Set minimum date to todayundefined<br>            const today = new Date().toISOString().split('T')[0];undefined<br>            document.getElementById('startDate').min = today;undefined<br>            document.getElementById('endDate').min = today;undefined<br>            document.getElementById('compensatoryWorkStartDate').min = today;undefined<br>            document.getElementById('compensatoryWorkEndDate').min = today;undefined<br>undefined<br>            // Setup file upload listenerundefined<br>            document.getElementById('medicalCertificate').addEventListener('change', handleFileUpload);undefined<br>undefined<br>            updateLeaveHistory();undefined<br>            checkNotifications();undefined<br>        }undefined<br>undefined<br>        function showManagerDashboard() {undefined<br>            document.getElementById('navigationTabs').style.display = 'none';undefined<br>            document.getElementById('managerLogin').style.display = 'none';undefined<br>            document.getElementById('managerDashboard').style.display = 'block';undefined<br>            populateEmployeeSelect();undefined<br>            updateManagerDashboard();undefined<br>            generateLeaveCalendar();undefined<br>            updateLockedDatesDisplay();undefined<br>            checkManagerNotifications();undefined<br>        }undefined<br>undefined<br>        function showAdminDashboard() {undefined<br>            document.getElementById('navigationTabs').style.display = 'none';undefined<br>            document.getElementById('adminLogin').style.display = 'none';undefined<br>            document.getElementById('adminDashboard').style.display = 'block';undefined<br>            updateAdminDashboard();undefined<br>            loadGoogleSheetsSettings();undefined<br>        }undefined<br>undefined<br>        // Compensatory work functionsundefined<br>        function showCompensatoryWorkModal() {undefined<br>            document.getElementById('compensatoryWorkModal').style.display = 'flex';undefined<br>        }undefined<br>undefined<br>        function closeCompensatoryWorkModal() {undefined<br>            document.getElementById('compensatoryWorkModal').style.display = 'none';undefined<br>            document.getElementById('compensatoryWorkStartDate').value = '';undefined<br>            document.getElementById('compensatoryWorkEndDate').value = '';undefined<br>            document.getElementById('compensatoryWorkDays').value = '1';undefined<br>            document.getElementById('compensatoryWorkReason').value = '';undefined<br>        }undefined<br>undefined<br>        function submitCompensatoryWorkRequest() {undefined<br>            const startDate = document.getElementById('compensatoryWorkStartDate').value;undefined<br>            const endDate = document.getElementById('compensatoryWorkEndDate').value;undefined<br>            const days = parseInt(document.getElementById('compensatoryWorkDays').value);undefined<br>            const reason = document.getElementById('compensatoryWorkReason').value.trim();undefined<br>undefined<br>            if (!startDate || !endDate || !reason) {undefined<br>                alert('กรุณากรอกข้อมูลให้ครบถ้วน');undefined<br>                return;undefined<br>            }undefined<br>undefined<br>            // Validate date rangeundefined<br>            if (new Date(startDate) > new Date(endDate)) {undefined<br>                alert('วันที่เริ่มต้นต้องไม่เกินวันที่สิ้นสุด');undefined<br>                return;undefined<br>            }undefined<br>undefined<br>            const request = {undefined<br>                id: Date.now(),undefined<br>                employee: currentUser,undefined<br>                startDate: startDate,undefined<br>                endDate: endDate,undefined<br>                days: days,undefined<br>                reason: reason,undefined<br>                status: 'pending',undefined<br>                submittedAt: new Date().toLocaleString('th-TH'),undefined<br>                type: 'compensatory_work'undefined<br>            };undefined<br>undefined<br>            compensatoryWorkRequests.push(request);undefined<br>            localStorage.setItem('compensatoryWorkRequests', JSON.stringify(compensatoryWorkRequests));undefined<br>undefined<br>            // Notify managerundefined<br>            const dateRange = startDate === endDate ? undefined<br>                formatDateThai(startDate) : undefined<br>                `${formatDateThai(startDate)} ถึง ${formatDateThai(endDate)}`;undefined<br>            showManagerNotification(`${currentUser} แจ้งมาทำงานในวันหยุด ${dateRange}`);undefined<br>undefined<br>            closeCompensatoryWorkModal();undefined<br>            alert('ยื่นคำขอมาทำงานในวันหยุดเรียบร้อยแล้ว');undefined<br>            updateLeaveHistory();undefined<br>        }undefined<br>undefined<br>        // Leave request functionsundefined<br>        function submitLeaveRequest() {undefined<br>            const leaveType = document.getElementById('leaveType').value;undefined<br>            const leaveDays = parseInt(document.getElementById('leaveDays').value);undefined<br>            const startDate = document.getElementById('startDate').value;undefined<br>            const endDate = document.getElementById('endDate').value;undefined<br>            const reason = document.getElementById('leaveReason').value.trim();undefined<br>undefined<br>            if (!startDate || !endDate) {undefined<br>                alert('กรุณาเลือกวันที่');undefined<br>                return;undefined<br>            }undefined<br>undefined<br>            if (!reason) {undefined<br>                showWhereAreYouGoingPopup();undefined<br>                return;undefined<br>            }undefined<br>undefined<br>            // Check if dates are lockedundefined<br>            if (isDateLocked(startDate, endDate)) {undefined<br>                showCannotLeavePopup('วันที่ถูกล็อค! 🔒', 'วันที่เลือกถูกล็อคแล้วจ้า ไม่สามารถลาได้นะคะ 😅');undefined<br>                return;undefined<br>            }undefined<br>undefined<br>            // Check maximum 3 people per dayundefined<br>            if (!canTakeLeave(startDate, endDate)) {undefined<br>                showCannotLeavePopup('คนลาเต็มแล้ว! 😵', 'มีพนักงานลาครบ 3 คนแล้วในวันที่เลือก ลองเลือกวันอื่นดูนะคะ 🤷‍♀️');undefined<br>                return;undefined<br>            }undefined<br>undefined<br>            const balance = employeeBalances[currentUser];undefined<br>            if (balance[leaveType] < leaveDays) {undefined<br>                showCannotLeavePopup('วันลาไม่พอ! 💸', `วันลา${getLeaveTypeText(leaveType)}คงเหลือไม่เพียงพอจ้า เหลือแค่ ${balance[leaveType]} วันเท่านั้น 😢`);undefined<br>                return;undefined<br>            }undefined<br>undefined<br>            const request = {undefined<br>                id: Date.now(),undefined<br>                employee: currentUser,undefined<br>                type: leaveType,undefined<br>                days: leaveDays,undefined<br>                startDate: startDate,undefined<br>                endDate: endDate,undefined<br>                reason: reason,undefined<br>                status: 'pending',undefined<br>                submittedAt: new Date().toLocaleString('th-TH')undefined<br>            };undefined<br>undefined<br>            leaveRequests.push(request);undefined<br>            localStorage.setItem('leaveRequests', JSON.stringify(leaveRequests));undefined<br>undefined<br>            // Notify managerundefined<br>            showManagerNotification(`${currentUser} ยื่นคำขอลา${getLeaveTypeText(leaveType)} ${leaveDays} วัน`);undefined<br>undefined<br>            // Clear formundefined<br>            document.getElementById('leaveReason').value = '';undefined<br>            document.getElementById('startDate').value = '';undefined<br>            document.getElementById('endDate').value = '';undefined<br>            document.getElementById('leaveDays').value = '1';undefined<br>            clearFile();undefined<br>undefined<br>            alert('ยื่นคำขอลาเรียบร้อยแล้ว');undefined<br>            updateLeaveHistory();undefined<br>        }undefined<br>undefined<br>        function updateLeaveHistory() {undefined<br>            const leaveHistory = leaveRequests.filter(req => req.employee === currentUser);undefined<br>            const compensatoryHistory = compensatoryWorkRequests.filter(req => req.employee === currentUser);undefined<br>            const allHistory = [...leaveHistory, ...compensatoryHistory].sort((a, b) => new Date(b.submittedAt) - new Date(a.submittedAt));undefined<br>undefined<br>            const historyDiv = document.getElementById('leaveHistory');undefined<br>undefined<br>            if (allHistory.length === 0) {undefined<br>                historyDiv.innerHTML = 'undefined<p class="text-gray-500">ยังไม่มีประวัติการลา</p>';undefined<br>                return;undefined<br>            }undefined<br>undefined<br>            historyDiv.innerHTML = allHistory.map(req => {undefined<br>                const statusColor = req.status === 'approved' ? 'green' : undefined<br>                                  req.status === 'rejected' ? 'red' : 'yellow';undefined<br>                const statusText = req.status === 'approved' ? 'อนุมัติ' : undefined<br>                                 req.status === 'rejected' ? 'ปฏิเสธ' : 'รออนุมัติ';undefined<br>undefined<br>                const isCompensatoryWork = req.type === 'compensatory_work';undefined<br>                const title = isCompensatoryWork ? undefined<br>                    `มาทำงานในวันหยุด - ${req.days} วัน` :undefined<br>                    `${getLeaveTypeText(req.type)} - ${req.days} วัน`;undefined<br>                const dateInfo = isCompensatoryWork ? undefined<br>                    (req.startDate === req.endDate ? undefined<br>                        `วันที่: ${formatDateThai(req.startDate)}` :undefined<br>                        `${formatDateThai(req.startDate)} ถึง ${formatDateThai(req.endDate)}`) :undefined<br>                    `${formatDateThai(req.startDate)} ถึง ${formatDateThai(req.endDate)}`;undefined<br>undefined<br>                return `undefined<br>undefined<div class="bg-white border border-gray-200 rounded-lg p-4">undefined<br>undefined<div class="flex justify-between items-start">undefined<br>undefined<div>undefined<br>undefined<h4 class="font-semibold">${title}</h4>undefined<br>undefined<p class="text-sm text-gray-600">${dateInfo}</p>undefined<br>undefined<p class="text-sm text-gray-600">เหตุผล: ${req.reason}</p>undefined<br>undefined<p class="text-xs text-gray-500">ยื่นเมื่อ: ${req.submittedAt}</p>undefined<br>undefined</div>undefined<br>undefined<span class="px-3 py-1 rounded-full text-sm bg-${statusColor}-100 text-${statusColor}-800">undefined<br>                                ${statusText}undefined<br>undefined</span>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>                `;undefined<br>            }).join('');undefined<br>        }undefined<br>undefined<br>        function updateManagerDashboard() {undefined<br>            const pendingLeave = leaveRequests.filter(req => req.status === 'pending');undefined<br>            const pendingCompensatory = compensatoryWorkRequests.filter(req => req.status === 'pending');undefined<br>            const allPending = [...pendingLeave, ...pendingCompensatory];undefined<br>undefined<br>            const pendingDiv = document.getElementById('pendingRequests');undefined<br>undefined<br>            if (allPending.length === 0) {undefined<br>                pendingDiv.innerHTML = 'undefined<p class="text-gray-500">ไม่มีคำขอที่รออนุมัติ</p>';undefined<br>            } else {undefined<br>                pendingDiv.innerHTML = allPending.map(req => {undefined<br>                    const isCompensatoryWork = req.type === 'compensatory_work';undefined<br>                    const title = isCompensatoryWork ? undefined<br>                        `${req.employee} - มาทำงานในวันหยุด` :undefined<br>                        `${req.employee} - ${getLeaveTypeText(req.type)}`;undefined<br>                    const details = isCompensatoryWork ?undefined<br>                        (req.startDate === req.endDate ? undefined<br>                            `วันที่: ${formatDateThai(req.startDate)}` :undefined<br>                            `${req.days} วัน (${formatDateThai(req.startDate)} ถึง ${formatDateThai(req.endDate)})`) :undefined<br>                        `${req.days} วัน (${formatDateThai(req.startDate)} ถึง ${formatDateThai(req.endDate)})`;undefined<br>undefined<br>                    return `undefined<br>undefined<div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">undefined<br>undefined<div class="flex justify-between items-start">undefined<br>undefined<div>undefined<br>undefined<h4 class="font-semibold">${title}</h4>undefined<br>undefined<p class="text-sm text-gray-600">${details}</p>undefined<br>undefined<p class="text-sm text-gray-600">เหตุผล: ${req.reason}</p>undefined<br>undefined<p class="text-xs text-gray-500">ยื่นเมื่อ: ${req.submittedAt}</p>undefined<br>undefined</div>undefined<br>undefined<div class="space-x-2">undefined<br>undefined<button onclick="${isCompensatoryWork ? 'approveCompensatoryWork' : 'approveRequest'}(${req.id})" class="bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded text-sm">อนุมัติ</button>undefined<br>undefined<button onclick="${isCompensatoryWork ? 'rejectCompensatoryWork' : 'rejectRequest'}(${req.id})" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm">ปฏิเสธ</button>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>                    `;undefined<br>                }).join('');undefined<br>            }undefined<br>undefined<br>            // Show all requestsundefined<br>            const allLeave = leaveRequests.map(req => ({...req, requestType: 'leave'}));undefined<br>            const allCompensatory = compensatoryWorkRequests.map(req => ({...req, requestType: 'compensatory'}));undefined<br>            const allRequests = [...allLeave, ...allCompensatory].sort((a, b) => new Date(b.submittedAt) - new Date(a.submittedAt));undefined<br>undefined<br>            const allDiv = document.getElementById('allRequests');undefined<br>            allDiv.innerHTML = allRequests.map(req => {undefined<br>                const statusColor = req.status === 'approved' ? 'green' : undefined<br>                                  req.status === 'rejected' ? 'red' : 'yellow';undefined<br>                const statusText = req.status === 'approved' ? 'อนุมัติ' : undefined<br>                                 req.status === 'rejected' ? 'ปฏิเสธ' : 'รออนุมัติ';undefined<br>undefined<br>                const isCompensatoryWork = req.requestType === 'compensatory';undefined<br>                const title = isCompensatoryWork ? undefined<br>                    `${req.employee} - มาทำงานในวันหยุด` :undefined<br>                    `${req.employee} - ${getLeaveTypeText(req.type)}`;undefined<br>                const details = isCompensatoryWork ?undefined<br>                    (req.startDate === req.endDate ? undefined<br>                        `วันที่: ${formatDateThai(req.startDate)}` :undefined<br>                        `${req.days} วัน (${formatDateThai(req.startDate)} ถึง ${formatDateThai(req.endDate)})`) :undefined<br>                    `${req.days} วัน (${formatDateThai(req.startDate)} ถึง ${formatDateThai(req.endDate)})`;undefined<br>undefined<br>                return `undefined<br>undefined<div class="bg-white border border-gray-200 rounded-lg p-4">undefined<br>undefined<div class="flex justify-between items-start">undefined<br>undefined<div>undefined<br>undefined<h4 class="font-semibold">${title}</h4>undefined<br>undefined<p class="text-sm text-gray-600">${details}</p>undefined<br>undefined<p class="text-sm text-gray-600">เหตุผล: ${req.reason}</p>undefined<br>undefined<p class="text-xs text-gray-500">ยื่นเมื่อ: ${req.submittedAt}</p>undefined<br>undefined</div>undefined<br>undefined<span class="px-3 py-1 rounded-full text-sm bg-${statusColor}-100 text-${statusColor}-800">undefined<br>                                ${statusText}undefined<br>undefined</span>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>                `;undefined<br>            }).join('');undefined<br>        }undefined<br>undefined<br>        function updateAdminDashboard() {undefined<br>            // Update employee listundefined<br>            const employeeListDiv = document.getElementById('employeeList');undefined<br>            employeeListDiv.innerHTML = employees.map(emp => {undefined<br>                const balance = employeeBalances[emp];undefined<br>                return `undefined<br>undefined<div class="bg-white border border-gray-200 rounded-lg p-4">undefined<br>undefined<h4 class="font-semibold mb-2">${emp}</h4>undefined<br>undefined<div class="space-y-1 text-sm">undefined<br>undefined<div class="flex justify-between">undefined<br>undefined<span>ลาพักผ่อน:</span>undefined<br>undefined<span class="font-medium">${balance.vacation} วัน</span>undefined<br>undefined</div>undefined<br>undefined<div class="flex justify-between">undefined<br>undefined<span>ลาป่วย:</span>undefined<br>undefined<span class="font-medium">${balance.sick} วัน</span>undefined<br>undefined</div>undefined<br>undefined<div class="flex justify-between">undefined<br>undefined<span>วันหยุดประจำปี:</span>undefined<br>undefined<span class="font-medium">${balance.annual} วัน</span>undefined<br>undefined</div>undefined<br>undefined<div class="flex justify-between">undefined<br>undefined<span>วันหยุดชดเชย:</span>undefined<br>undefined<span class="font-medium">${balance.compensatory} วัน</span>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined<button onclick="resetEmployeeBalance('${emp}')" class="mt-2 w-full bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-sm">undefined<br>                            รีเซ็ตวันลาundefined<br>undefined</button>undefined<br>undefined</div>undefined<br>                `;undefined<br>            }).join('');undefined<br>undefined<br>            // Update statisticsundefined<br>            const pending = [...leaveRequests.filter(req => req.status === 'pending'), ...compensatoryWorkRequests.filter(req => req.status === 'pending')].length;undefined<br>            const approved = [...leaveRequests.filter(req => req.status === 'approved'), ...compensatoryWorkRequests.filter(req => req.status === 'approved')].length;undefined<br>            const rejected = [...leaveRequests.filter(req => req.status === 'rejected'), ...compensatoryWorkRequests.filter(req => req.status === 'rejected')].length;undefined<br>undefined<br>            document.getElementById('pendingCount').textContent = pending;undefined<br>            document.getElementById('approvedCount').textContent = approved;undefined<br>            document.getElementById('rejectedCount').textContent = rejected;undefined<br>        }undefined<br>undefined<br>        // Manager functionsundefined<br>        function approveRequest(id) {undefined<br>            const request = leaveRequests.find(req => req.id === id);undefined<br>            if (request) {undefined<br>                request.status = 'approved';undefined<br>undefined<br>                // Deduct leave balanceundefined<br>                employeeBalances[request.employee][request.type] -= request.days;undefined<br>undefined<br>                localStorage.setItem('leaveRequests', JSON.stringify(leaveRequests));undefined<br>                localStorage.setItem('employeeBalances', JSON.stringify(employeeBalances));undefined<br>undefined<br>                updateManagerDashboard();undefined<br>                alert('อนุมัติคำขอเรียบร้อยแล้ว');undefined<br>            }undefined<br>        }undefined<br>undefined<br>        function rejectRequest(id) {undefined<br>            const request = leaveRequests.find(req => req.id === id);undefined<br>            if (request) {undefined<br>                request.status = 'rejected';undefined<br>                localStorage.setItem('leaveRequests', JSON.stringify(leaveRequests));undefined<br>                updateManagerDashboard();undefined<br>                alert('ปฏิเสธคำขอเรียบร้อยแล้ว');undefined<br>            }undefined<br>        }undefined<br>undefined<br>        function approveCompensatoryWork(id) {undefined<br>            const request = compensatoryWorkRequests.find(req => req.id === id);undefined<br>            if (request) {undefined<br>                request.status = 'approved';undefined<br>undefined<br>                // Add compensatory leave balance based on number of daysundefined<br>                employeeBalances[request.employee].compensatory += request.days;undefined<br>undefined<br>                localStorage.setItem('compensatoryWorkRequests', JSON.stringify(compensatoryWorkRequests));undefined<br>                localStorage.setItem('employeeBalances', JSON.stringify(employeeBalances));undefined<br>undefined<br>                updateManagerDashboard();undefined<br>                alert(`อนุมัติคำขอมาทำงานในวันหยุดเรียบร้อยแล้ว และเพิ่มวันหยุดชดเชย ${request.days} วันให้พนักงาน`);undefined<br>            }undefined<br>        }undefined<br>undefined<br>        function rejectCompensatoryWork(id) {undefined<br>            const request = compensatoryWorkRequests.find(req => req.id === id);undefined<br>            if (request) {undefined<br>                request.status = 'rejected';undefined<br>                localStorage.setItem('compensatoryWorkRequests', JSON.stringify(compensatoryWorkRequests));undefined<br>                updateManagerDashboard();undefined<br>                alert('ปฏิเสธคำขอมาทำงานในวันหยุดเรียบร้อยแล้ว');undefined<br>            }undefined<br>        }undefined<br>undefined<br>        // Admin functionsundefined<br>        function resetEmployeeBalance(employee) {undefined<br>            if (confirm(`ต้องการรีเซ็ตวันลาของ ${employee} หรือไม่?`)) {undefined<br>                employeeBalances[employee] = {undefined<br>                    vacation: 15,undefined<br>                    sick: 30,undefined<br>                    annual: 19,undefined<br>                    compensatory: 0undefined<br>                };undefined<br>                localStorage.setItem('employeeBalances', JSON.stringify(employeeBalances));undefined<br>                updateAdminDashboard();undefined<br>                alert('รีเซ็ตวันลาเรียบร้อยแล้ว');undefined<br>            }undefined<br>        }undefined<br>undefined<br>        // Utility functionsundefined<br>        function getLeaveTypeText(type) {undefined<br>            const types = {undefined<br>                vacation: 'ลาพักผ่อน',undefined<br>                sick: 'ลาป่วย',undefined<br>                annual: 'วันหยุดประจำปี',undefined<br>                compensatory: 'วันหยุดชดเชย'undefined<br>            };undefined<br>            return types[type] || type;undefined<br>        }undefined<br>undefined<br>        function logout() {undefined<br>            currentUser = null;undefined<br>            currentRole = null;undefined<br>undefined<br>            // Hide notification barundefined<br>            hideNotification();undefined<br>undefined<br>            // Show navigation tabsundefined<br>            document.getElementById('navigationTabs').style.display = 'flex';undefined<br>undefined<br>            // Hide all dashboardsundefined<br>            document.getElementById('employeeDashboard').style.display = 'none';undefined<br>            document.getElementById('managerDashboard').style.display = 'none';undefined<br>            document.getElementById('adminDashboard').style.display = 'none';undefined<br>undefined<br>            // Show employee login by defaultundefined<br>            switchTab('employee');undefined<br>undefined<br>            // Clear form inputsundefined<br>            document.getElementById('employeeUsername').value = '';undefined<br>            document.getElementById('managerPassword').value = '';undefined<br>            document.getElementById('adminPassword').value = '';undefined<br>        }undefined<br>undefined<br>        // Auto-calculate days and end dateundefined<br>        document.getElementById('startDate').addEventListener('change', calculateDaysFromDates);undefined<br>        document.getElementById('endDate').addEventListener('change', calculateDaysFromDates);undefined<br>undefined<br>        function calculateDaysFromDates() {undefined<br>            const startDate = document.getElementById('startDate').value;undefined<br>            const endDate = document.getElementById('endDate').value;undefined<br>undefined<br>            if (startDate && endDate) {undefined<br>                const start = new Date(startDate);undefined<br>                const end = new Date(endDate);undefined<br>undefined<br>                if (end < start) {undefined<br>                    document.getElementById('endDate').value = startDate;undefined<br>                    document.getElementById('leaveDays').value = 1;undefined<br>                    return;undefined<br>                }undefined<br>undefined<br>                const diffTime = Math.abs(end - start);undefined<br>                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;undefined<br>undefined<br>                document.getElementById('leaveDays').value = diffDays;undefined<br>            } else if (startDate && !endDate) {undefined<br>                document.getElementById('endDate').value = startDate;undefined<br>                document.getElementById('leaveDays').value = 1;undefined<br>            }undefined<br>        }undefined<br>undefined<br>        // Compensatory work date calculationsundefined<br>        function calculateCompensatoryEndDate() {undefined<br>            const startDate = document.getElementById('compensatoryWorkStartDate').value;undefined<br>            const days = parseInt(document.getElementById('compensatoryWorkDays').value) || 1;undefined<br>undefined<br>            if (startDate) {undefined<br>                const start = new Date(startDate);undefined<br>                const end = new Date(start);undefined<br>                end.setDate(start.getDate() + days - 1);undefined<br>undefined<br>                document.getElementById('compensatoryWorkEndDate').value = end.toISOString().split('T')[0];undefined<br>            }undefined<br>        }undefined<br>undefined<br>        function calculateCompensatoryDays() {undefined<br>            const startDate = document.getElementById('compensatoryWorkStartDate').value;undefined<br>            const endDate = document.getElementById('compensatoryWorkEndDate').value;undefined<br>undefined<br>            if (startDate && endDate) {undefined<br>                const start = new Date(startDate);undefined<br>                const end = new Date(endDate);undefined<br>                const diffTime = Math.abs(end - start);undefined<br>                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;undefined<br>undefined<br>                document.getElementById('compensatoryWorkDays').value = diffDays;undefined<br>            }undefined<br>        }undefined<br>undefined<br>        function calculateCompensatoryEndDateFromDays() {undefined<br>            const startDate = document.getElementById('compensatoryWorkStartDate').value;undefined<br>            const days = parseInt(document.getElementById('compensatoryWorkDays').value) || 1;undefined<br>undefined<br>            if (startDate) {undefined<br>                const start = new Date(startDate);undefined<br>                const end = new Date(start);undefined<br>                end.setDate(start.getDate() + days - 1);undefined<br>undefined<br>                document.getElementById('compensatoryWorkEndDate').value = end.toISOString().split('T')[0];undefined<br>            }undefined<br>        }undefined<br>undefined<br>        // Manager functions for calendar and leave managementundefined<br>        function lockCalendar() {undefined<br>            const startDate = document.getElementById('lockStartDate').value;undefined<br>            const endDate = document.getElementById('lockEndDate').value;undefined<br>            const reason = document.getElementById('lockReason').value.trim();undefined<br>undefined<br>            if (!startDate || !endDate || !reason) {undefined<br>                alert('กรุณากรอกข้อมูลให้ครบถ้วน');undefined<br>                return;undefined<br>            }undefined<br>undefined<br>            const lockPeriod = {undefined<br>                id: Date.now(),undefined<br>                startDate: startDate,undefined<br>                endDate: endDate,undefined<br>                reason: reasonundefined<br>            };undefined<br>undefined<br>            lockedDates.push(lockPeriod);undefined<br>            localStorage.setItem('lockedDates', JSON.stringify(lockedDates));undefined<br>undefined<br>            // Clear formundefined<br>            document.getElementById('lockStartDate').value = '';undefined<br>            document.getElementById('lockEndDate').value = '';undefined<br>            document.getElementById('lockReason').value = '';undefined<br>undefined<br>            updateLockedDatesDisplay();undefined<br>            generateLeaveCalendar();undefined<br>            alert('ล็อคปฏิทินเรียบร้อยแล้ว');undefined<br>        }undefined<br>undefined<br>        function adjustAllLeaves() {undefined<br>            const vacation = parseInt(document.getElementById('adjustVacation').value);undefined<br>            const sick = parseInt(document.getElementById('adjustSick').value);undefined<br>            const annual = parseInt(document.getElementById('adjustAnnual').value);undefined<br>            const compensatory = parseInt(document.getElementById('adjustCompensatory').value);undefined<br>undefined<br>            if (confirm('ต้องการปรับวันลาของพนักงานทั้งหมดหรือไม่?')) {undefined<br>                employees.forEach(emp => {undefined<br>                    employeeBalances[emp] = {undefined<br>                        vacation: vacation,undefined<br>                        sick: sick,undefined<br>                        annual: annual,undefined<br>                        compensatory: compensatoryundefined<br>                    };undefined<br>                });undefined<br>undefined<br>                localStorage.setItem('employeeBalances', JSON.stringify(employeeBalances));undefined<br>                alert('ปรับวันลาทั้งหมดเรียบร้อยแล้ว');undefined<br>            }undefined<br>        }undefined<br>undefined<br>        function isDateLocked(startDate, endDate) {undefined<br>            const start = new Date(startDate);undefined<br>            const end = new Date(endDate);undefined<br>undefined<br>            return lockedDates.some(lock => {undefined<br>                const lockStart = new Date(lock.startDate);undefined<br>                const lockEnd = new Date(lock.endDate);undefined<br>                return (start <= lockEnd && end >= lockStart);undefined<br>            });undefined<br>        }undefined<br>undefined<br>        function canTakeLeave(startDate, endDate) {undefined<br>            const start = new Date(startDate);undefined<br>            const end = new Date(endDate);undefined<br>undefined<br>            for (let d = new Date(start); d <= end; d.setDate(d.getDate() + 1)) {undefined<br>                const dateStr = d.toISOString().split('T')[0];undefined<br>                const approvedLeaves = leaveRequests.filter(req =>undefined<br>                    req.status === 'approved' && undefined<br>                    dateStr >= req.startDate && undefined<br>                    dateStr <= req.endDateundefined<br>                ).length;undefined<br>undefined<br>                if (approvedLeaves >= 3) {undefined<br>                    return false;undefined<br>                }undefined<br>            }undefined<br>            return true;undefined<br>        }undefined<br>undefined<br>        function updateLockedDatesDisplay() {undefined<br>            const container = document.getElementById('lockedDates');undefined<br>undefined<br>            if (lockedDates.length === 0) {undefined<br>                container.innerHTML = 'undefined<p class="text-gray-500">ไม่มีวันที่ถูกล็อค</p>';undefined<br>                return;undefined<br>            }undefined<br>undefined<br>            container.innerHTML = lockedDates.map(lock => `undefined<br>undefined<div class="bg-red-50 border border-red-200 rounded p-3 flex justify-between items-center">undefined<br>undefined<div>undefined<br>undefined<span class="font-medium">${formatDateThai(lock.startDate)} ถึง ${formatDateThai(lock.endDate)}</span>undefined<br>undefined<p class="text-sm text-gray-600">${lock.reason}</p>undefined<br>undefined</div>undefined<br>undefined<button onclick="removeLock(${lock.id})" class="text-red-600 hover:text-red-800">ลบ</button>undefined<br>undefined</div>undefined<br>            `).join('');undefined<br>        }undefined<br>undefined<br>        function removeLock(lockId) {undefined<br>            if (confirm('ต้องการลบการล็อคนี้หรือไม่?')) {undefined<br>                lockedDates = lockedDates.filter(lock => lock.id !== lockId);undefined<br>                localStorage.setItem('lockedDates', JSON.stringify(lockedDates));undefined<br>                updateLockedDatesDisplay();undefined<br>                generateLeaveCalendar();undefined<br>            }undefined<br>        }undefined<br>undefined<br>        function generateLeaveCalendar() {undefined<br>            const calendar = document.getElementById('leaveCalendar');undefined<br>            const today = new Date();undefined<br>            const currentMonth = today.getMonth();undefined<br>            const currentYear = today.getFullYear();undefined<br>undefined<br>            // Get first day of month and number of daysundefined<br>            const firstDay = new Date(currentYear, currentMonth, 1);undefined<br>            const lastDay = new Date(currentYear, currentMonth + 1, 0);undefined<br>            const daysInMonth = lastDay.getDate();undefined<br>            const startingDayOfWeek = firstDay.getDay();undefined<br>undefined<br>            // Calendar headerundefined<br>            const monthNames = ['มกราคม', 'กุมภาพันธ์', 'มีนาคม', 'เมษายน', 'พฤษภาคม', 'มิถุนายน',undefined<br>                              'กรกฎาคม', 'สิงหาคม', 'กันยายน', 'ตุลาคม', 'พฤศจิกายน', 'ธันวาคม'];undefined<br>undefined<br>            let calendarHTML = `undefined<br>undefined<div class="col-span-7 text-center font-bold text-lg mb-4">undefined<br>                    ${monthNames[currentMonth]} ${currentYear + 543}undefined<br>undefined</div>undefined<br>undefined<div class="font-semibold">อา</div>undefined<br>undefined<div class="font-semibold">จ</div>undefined<br>undefined<div class="font-semibold">อ</div>undefined<br>undefined<div class="font-semibold">พ</div>undefined<br>undefined<div class="font-semibold">พฤ</div>undefined<br>undefined<div class="font-semibold">ศ</div>undefined<br>undefined<div class="font-semibold">ส</div>undefined<br>            `;undefined<br>undefined<br>            // Empty cells for days before month startsundefined<br>            for (let i = 0; i < startingDayOfWeek; i++) {undefined<br>                calendarHTML += 'undefined<div></div>';undefined<br>            }undefined<br>undefined<br>            // Days of the monthundefined<br>            for (let day = 1; day <= daysInMonth; day++) {undefined<br>                const date = new Date(currentYear, currentMonth, day);undefined<br>                // Fix timezone issue by using local date stringundefined<br>                const year = date.getFullYear();undefined<br>                const month = String(date.getMonth() + 1).padStart(2, '0');undefined<br>                const dayStr = String(day).padStart(2, '0');undefined<br>                const dateStr = `${year}-${month}-${dayStr}`;undefined<br>undefined<br>                // Check if date is lockedundefined<br>                const isLocked = lockedDates.some(lock =>undefined<br>                    dateStr >= lock.startDate && dateStr <= lock.endDateundefined<br>                );undefined<br>undefined<br>                // Count approved leaves for this dateundefined<br>                const leavesCount = leaveRequests.filter(req =>undefined<br>                    req.status === 'approved' && undefined<br>                    dateStr >= req.startDate && undefined<br>                    dateStr <= req.endDateundefined<br>                ).length;undefined<br>undefined<br>                let cellClass = 'p-2 border rounded cursor-pointer hover:bg-gray-100';undefined<br>                let cellContent = day;undefined<br>undefined<br>                if (isLocked) {undefined<br>                    cellClass += ' bg-red-200';undefined<br>                } else if (leavesCount >= 3) {undefined<br>                    cellClass += ' bg-orange-300';undefined<br>                } else if (leavesCount > 0) {undefined<br>                    cellClass += ' bg-yellow-200';undefined<br>                }undefined<br>undefined<br>                if (leavesCount > 0) {undefined<br>                    cellContent += `undefined<br>undefined<span class="text-xs">${leavesCount} คน</span>`;undefined<br>                }undefined<br>undefined<br>                calendarHTML += `undefined<div class="${cellClass}" onclick="showDayDetails('${dateStr}')">${cellContent}</div>`;undefined<br>            }undefined<br>undefined<br>            calendar.innerHTML = calendarHTML;undefined<br>        }undefined<br>undefined<br>        function showDayDetails(date) {undefined<br>            const dayLeaves = leaveRequests.filter(req =>undefined<br>                req.status === 'approved' && undefined<br>                date >= req.startDate && undefined<br>                date <= req.endDateundefined<br>            );undefined<br>undefined<br>            const lockedInfo = lockedDates.find(lock =>undefined<br>                date >= lock.startDate && date <= lock.endDateundefined<br>            );undefined<br>undefined<br>            const formattedDate = formatDateThai(date);undefined<br>            let message = `วันที่ ${formattedDate}\n\n`;undefined<br>undefined<br>            if (lockedInfo) {undefined<br>                message += `🔒 วันนี้ถูกล็อค\nเหตุผล: ${lockedInfo.reason}\n\n`;undefined<br>            }undefined<br>undefined<br>            if (dayLeaves.length === 0 && !lockedInfo) {undefined<br>                showPopup('ข้อมูลวันที่', message + 'ไม่มีใครลาในวันนี้');undefined<br>                return;undefined<br>            }undefined<br>undefined<br>            if (dayLeaves.length > 0) {undefined<br>                message += `👥 ผู้ลาในวันนี้ (${dayLeaves.length} คน):\n`;undefined<br>                dayLeaves.forEach(leave => {undefined<br>                    message += `• ${leave.employee} - ${getLeaveTypeText(leave.type)}\n`;undefined<br>                });undefined<br>            }undefined<br>undefined<br>            showPopup('ข้อมูลวันที่', message);undefined<br>        }undefined<br>undefined<br>        // File upload handlingundefined<br>        function handleFileUpload(event) {undefined<br>            const file = event.target.files[0];undefined<br>            if (file) {undefined<br>                if (file.size > 5 * 1024 * 1024) { // 5MB limitundefined<br>                    alert('ไฟล์มีขนาดใหญ่เกินไป (สูงสุด 5MB)');undefined<br>                    return;undefined<br>                }undefined<br>undefined<br>                document.getElementById('fileName').textContent = file.name;undefined<br>                document.getElementById('filePreview').classList.remove('hidden');undefined<br>            }undefined<br>        }undefined<br>undefined<br>        function clearFile() {undefined<br>            document.getElementById('medicalCertificate').value = '';undefined<br>            document.getElementById('filePreview').classList.add('hidden');undefined<br>        }undefined<br>undefined<br>        // Calendar modal functionsundefined<br>        function showCalendarModal() {undefined<br>            document.getElementById('calendarModal').style.display = 'flex';undefined<br>            generateEmployeeCalendar();undefined<br>        }undefined<br>undefined<br>        function closeCalendarModal() {undefined<br>            document.getElementById('calendarModal').style.display = 'none';undefined<br>        }undefined<br>undefined<br>        function generateEmployeeCalendar() {undefined<br>            const calendar = document.getElementById('employeeCalendar');undefined<br>            const today = new Date();undefined<br>            const currentMonth = today.getMonth();undefined<br>            const currentYear = today.getFullYear();undefined<br>undefined<br>            const firstDay = new Date(currentYear, currentMonth, 1);undefined<br>            const lastDay = new Date(currentYear, currentMonth + 1, 0);undefined<br>            const daysInMonth = lastDay.getDate();undefined<br>            const startingDayOfWeek = firstDay.getDay();undefined<br>undefined<br>            const monthNames = ['มกราคม', 'กุมภาพันธ์', 'มีนาคม', 'เมษายน', 'พฤษภาคม', 'มิถุนายน',undefined<br>                              'กรกฎาคม', 'สิงหาคม', 'กันยายน', 'ตุลาคม', 'พฤศจิกายน', 'ธันวาคม'];undefined<br>undefined<br>            let calendarHTML = `undefined<br>undefined<div class="col-span-7 text-center font-bold text-lg mb-4">undefined<br>                    ${monthNames[currentMonth]} ${currentYear + 543}undefined<br>undefined</div>undefined<br>undefined<div class="font-semibold">อา</div>undefined<br>undefined<div class="font-semibold">จ</div>undefined<br>undefined<div class="font-semibold">อ</div>undefined<br>undefined<div class="font-semibold">พ</div>undefined<br>undefined<div class="font-semibold">พฤ</div>undefined<br>undefined<div class="font-semibold">ศ</div>undefined<br>undefined<div class="font-semibold">ส</div>undefined<br>            `;undefined<br>undefined<br>            for (let i = 0; i < startingDayOfWeek; i++) {undefined<br>                calendarHTML += 'undefined<div></div>';undefined<br>            }undefined<br>undefined<br>            for (let day = 1; day <= daysInMonth; day++) {undefined<br>                const date = new Date(currentYear, currentMonth, day);undefined<br>                // Fix timezone issue by using local date stringundefined<br>                const year = date.getFullYear();undefined<br>                const month = String(date.getMonth() + 1).padStart(2, '0');undefined<br>                const dayStr = String(day).padStart(2, '0');undefined<br>                const dateStr = `${year}-${month}-${dayStr}`;undefined<br>undefined<br>                const isLocked = lockedDates.some(lock =>undefined<br>                    dateStr >= lock.startDate && dateStr <= lock.endDateundefined<br>                );undefined<br>undefined<br>                const leavesCount = leaveRequests.filter(req =>undefined<br>                    req.status === 'approved' && undefined<br>                    dateStr >= req.startDate && undefined<br>                    dateStr <= req.endDateundefined<br>                ).length;undefined<br>undefined<br>                const myLeave = leaveRequests.find(req =>undefined<br>                    req.employee === currentUser &&undefined<br>                    req.status === 'approved' && undefined<br>                    dateStr >= req.startDate && undefined<br>                    dateStr <= req.endDateundefined<br>                );undefined<br>undefined<br>                let cellClass = 'p-2 border rounded cursor-pointer hover:bg-gray-100';undefined<br>                let cellContent = day;undefined<br>undefined<br>                if (myLeave) {undefined<br>                    cellClass += ' bg-blue-200';undefined<br>                } else if (isLocked) {undefined<br>                    cellClass += ' bg-red-200';undefined<br>                } else if (leavesCount >= 3) {undefined<br>                    cellClass += ' bg-orange-300';undefined<br>                } else if (leavesCount > 0) {undefined<br>                    cellClass += ' bg-yellow-200';undefined<br>                }undefined<br>undefined<br>                if (leavesCount > 0) {undefined<br>                    cellContent += `undefined<br>undefined<span class="text-xs">${leavesCount} คน</span>`;undefined<br>                }undefined<br>undefined<br>                calendarHTML += `undefined<div class="${cellClass}" onclick="showEmployeeDayDetails('${dateStr}')">${cellContent}</div>`;undefined<br>            }undefined<br>undefined<br>            calendar.innerHTML = calendarHTML;undefined<br>        }undefined<br>undefined<br>        function showEmployeeDayDetails(date) {undefined<br>            const dayLeaves = leaveRequests.filter(req =>undefined<br>                req.status === 'approved' && undefined<br>                date >= req.startDate && undefined<br>                date <= req.endDateundefined<br>            );undefined<br>undefined<br>            const lockedInfo = lockedDates.find(lock =>undefined<br>                date >= lock.startDate && date <= lock.endDateundefined<br>            );undefined<br>undefined<br>            const myLeave = dayLeaves.find(leave => leave.employee === currentUser);undefined<br>            const formattedDate = formatDateThai(date);undefined<br>undefined<br>            let message = `วันที่ ${formattedDate}\n\n`;undefined<br>undefined<br>            if (lockedInfo) {undefined<br>                message += `🔒 วันนี้ถูกล็อค\nเหตุผล: ${lockedInfo.reason}\n\n`;undefined<br>            }undefined<br>undefined<br>            if (myLeave) {undefined<br>                message += `✅ คุณลา: ${getLeaveTypeText(myLeave.type)}\n\n`;undefined<br>            }undefined<br>undefined<br>            if (dayLeaves.length > 0) {undefined<br>                message += `👥 ผู้ลาในวันนี้ (${dayLeaves.length} คน):\n`;undefined<br>                dayLeaves.forEach(leave => {undefined<br>                    const icon = leave.employee === currentUser ? '✅' : '•';undefined<br>                    message += `${icon} ${leave.employee} - ${getLeaveTypeText(leave.type)}\n`;undefined<br>                });undefined<br>            } else if (!lockedInfo) {undefined<br>                message += 'ไม่มีใครลาในวันนี้';undefined<br>            }undefined<br>undefined<br>            showPopup('ข้อมูลวันที่', message);undefined<br>        }undefined<br>undefined<br>        // Manager functionsundefined<br>        function populateEmployeeSelect() {undefined<br>            const select = document.getElementById('selectEmployee');undefined<br>            select.innerHTML = 'undefined<option value="">-- เลือกพนักงาน --</option>';undefined<br>undefined<br>            employees.forEach(emp => {undefined<br>                const option = document.createElement('option');undefined<br>                option.value = emp;undefined<br>                option.textContent = emp;undefined<br>                select.appendChild(option);undefined<br>            });undefined<br>undefined<br>            select.addEventListener('change', function() {undefined<br>                const selectedEmployee = this.value;undefined<br>                const adjustmentDiv = document.getElementById('individualAdjustment');undefined<br>undefined<br>                if (selectedEmployee) {undefined<br>                    const balance = employeeBalances[selectedEmployee];undefined<br>                    document.getElementById('adjustIndividualVacation').value = balance.vacation;undefined<br>                    document.getElementById('adjustIndividualSick').value = balance.sick;undefined<br>                    document.getElementById('adjustIndividualAnnual').value = balance.annual;undefined<br>                    document.getElementById('adjustIndividualCompensatory').value = balance.compensatory;undefined<br>                    adjustmentDiv.style.display = 'block';undefined<br>                } else {undefined<br>                    adjustmentDiv.style.display = 'none';undefined<br>                }undefined<br>            });undefined<br>        }undefined<br>undefined<br>        function adjustIndividualLeave() {undefined<br>            const selectedEmployee = document.getElementById('selectEmployee').value;undefined<br>            if (!selectedEmployee) {undefined<br>                alert('กรุณาเลือกพนักงาน');undefined<br>                return;undefined<br>            }undefined<br>undefined<br>            const vacation = parseInt(document.getElementById('adjustIndividualVacation').value);undefined<br>            const sick = parseInt(document.getElementById('adjustIndividualSick').value);undefined<br>            const annual = parseInt(document.getElementById('adjustIndividualAnnual').value);undefined<br>            const compensatory = parseInt(document.getElementById('adjustIndividualCompensatory').value);undefined<br>undefined<br>            if (confirm(`ต้องการปรับวันลาของ ${selectedEmployee} หรือไม่?`)) {undefined<br>                employeeBalances[selectedEmployee] = {undefined<br>                    vacation: vacation,undefined<br>                    sick: sick,undefined<br>                    annual: annual,undefined<br>                    compensatory: compensatoryundefined<br>                };undefined<br>undefined<br>                localStorage.setItem('employeeBalances', JSON.stringify(employeeBalances));undefined<br>                alert('ปรับวันลาเรียบร้อยแล้ว');undefined<br>undefined<br>                // Reset selectionundefined<br>                document.getElementById('selectEmployee').value = '';undefined<br>                document.getElementById('individualAdjustment').style.display = 'none';undefined<br>            }undefined<br>        }undefined<br>undefined<br>        // Notification systemundefined<br>        function showManagerNotification(message) {undefined<br>            if (currentRole === 'manager') {undefined<br>                document.getElementById('notificationText').textContent = message;undefined<br>                document.getElementById('notificationBar').style.display = 'block';undefined<br>undefined<br>                // Auto hide after 5 secondsundefined<br>                setTimeout(() => {undefined<br>                    hideNotification();undefined<br>                }, 5000);undefined<br>            }undefined<br>        }undefined<br>undefined<br>        function hideNotification() {undefined<br>            document.getElementById('notificationBar').style.display = 'none';undefined<br>        }undefined<br>undefined<br>        function checkNotifications() {undefined<br>            // Check for employee notifications (not implemented in this version)undefined<br>        }undefined<br>undefined<br>        function checkManagerNotifications() {undefined<br>            const pendingCount = leaveRequests.filter(req => req.status === 'pending').length + undefined<br>                               compensatoryWorkRequests.filter(req => req.status === 'pending').length;undefined<br>undefined<br>            if (pendingCount > 0) {undefined<br>                showManagerNotification(`มีคำขอรออนุมัติ ${pendingCount} รายการ`);undefined<br>            }undefined<br>        }undefined<br>undefined<br>        // Date formatting functionundefined<br>        function formatDateThai(dateStr) {undefined<br>            const date = new Date(dateStr);undefined<br>            const day = String(date.getDate()).padStart(2, '0');undefined<br>            const month = String(date.getMonth() + 1).padStart(2, '0');undefined<br>            const year = date.getFullYear();undefined<br>            return `${day}/${month}/${year}`;undefined<br>        }undefined<br>undefined<br>        // Popup functionundefined<br>        function showPopup(title, message) {undefined<br>            // Create popup modalundefined<br>            const popup = document.createElement('div');undefined<br>            popup.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';undefined<br>            popup.innerHTML = `undefined<br>undefined<div class="bg-white rounded-xl p-6 w-full max-w-md mx-4 max-h-[80vh] overflow-y-auto">undefined<br>undefined<div class="flex justify-between items-center mb-4">undefined<br>undefined<h3 class="text-lg font-semibold text-gray-800">${title}</h3>undefined<br>undefined<button onclick="this.closest('.fixed').remove()" class="text-gray-500 hover:text-gray-700">undefined<br>undefined<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">undefined<br>undefined<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>undefined<br>undefined</svg>undefined<br>undefined</button>undefined<br>undefined</div>undefined<br>undefined<div class="text-gray-700 whitespace-pre-line">${message}</div>undefined<br>undefined<div class="mt-4 text-right">undefined<br>undefined<button onclick="this.closest('.fixed').remove()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg">undefined<br>                            ปิดundefined<br>undefined</button>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>            `;undefined<br>            document.body.appendChild(popup);undefined<br>        }undefined<br>undefined<br>        // Cannot leave popup functionundefined<br>        function showCannotLeavePopup(title, message) {undefined<br>            const popup = document.createElement('div');undefined<br>            popup.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';undefined<br>            popup.innerHTML = `undefined<br>undefined<div class="bg-gradient-to-br from-red-100 via-pink-100 to-orange-100 rounded-2xl p-8 w-full max-w-lg mx-4 border-4 border-red-400 shadow-2xl error-popup">undefined<br>undefined<div class="text-center">undefined<br>undefined<div class="text-8xl mb-6 bounce">🚫</div>undefined<br>undefined<h3 class="text-3xl font-bold text-red-600 mb-4">ลาไม่ได้จ้า!</h3>undefined<br>undefined<div class="bg-white rounded-lg p-4 mb-6 border-2 border-red-200">undefined<br>undefined<h4 class="text-xl font-semibold text-red-700 mb-2">${title}</h4>undefined<br>undefined<div class="text-lg text-red-600">${message}</div>undefined<br>undefined</div>undefined<br>undefined<div class="flex justify-center space-x-3 mb-6">undefined<br>undefined<span class="text-3xl animate-bounce">😭</span>undefined<br>undefined<span class="text-3xl animate-bounce" style="animation-delay: 0.1s">💔</span>undefined<br>undefined<span class="text-3xl animate-bounce" style="animation-delay: 0.2s">🤦‍♀️</span>undefined<br>undefined<span class="text-3xl animate-bounce" style="animation-delay: 0.3s">😵‍💫</span>undefined<br>undefined</div>undefined<br>undefined<div class="space-y-3">undefined<br>undefined<button onclick="this.closest('.fixed').remove()" class="w-full bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600 text-white px-8 py-4 rounded-full font-bold text-xl transform hover:scale-105 transition-all duration-200 shadow-lg">undefined<br>                                เข้าใจแล้วจ้า! 😊undefined<br>undefined</button>undefined<br>undefined<div class="text-sm text-gray-600">💡 ลองเลือกวันอื่นดูนะคะ หรือติดต่อผู้จัดการ</div>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>            `;undefined<br>            document.body.appendChild(popup);undefined<br>undefined<br>            // Add shake animation to the popupundefined<br>            setTimeout(() => {undefined<br>                const popupContent = popup.querySelector('.error-popup');undefined<br>                popupContent.style.animation = 'shake 0.5s ease-in-out';undefined<br>            }, 100);undefined<br>undefined<br>            // Auto remove after 8 secondsundefined<br>            setTimeout(() => {undefined<br>                if (popup.parentNode) {undefined<br>                    popup.remove();undefined<br>                }undefined<br>            }, 8000);undefined<br>        }undefined<br>undefined<br>        // Funny error popup functionundefined<br>        function showFunnyErrorPopup(title, message) {undefined<br>            const popup = document.createElement('div');undefined<br>            popup.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';undefined<br>            popup.innerHTML = `undefined<br>undefined<div class="bg-gradient-to-br from-red-100 to-pink-100 rounded-xl p-6 w-full max-w-md mx-4 border-4 border-red-300 error-popup">undefined<br>undefined<div class="text-center">undefined<br>undefined<div class="text-6xl mb-4 bounce">🚨</div>undefined<br>undefined<h3 class="text-2xl font-bold text-red-600 mb-4">${title}</h3>undefined<br>undefined<div class="text-lg text-red-700 mb-6">${message}</div>undefined<br>undefined<div class="flex justify-center space-x-2 mb-4">undefined<br>undefined<span class="text-2xl">😵</span>undefined<br>undefined<span class="text-2xl">💥</span>undefined<br>undefined<span class="text-2xl">🤷‍♀️</span>undefined<br>undefined</div>undefined<br>undefined<button onclick="this.closest('.fixed').remove()" class="bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-full font-bold text-lg transform hover:scale-105 transition-transform">undefined<br>                            โอเคจ้า! 😊undefined<br>undefined</button>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>            `;undefined<br>            document.body.appendChild(popup);undefined<br>undefined<br>            // Auto remove after 5 secondsundefined<br>            setTimeout(() => {undefined<br>                if (popup.parentNode) {undefined<br>                    popup.remove();undefined<br>                }undefined<br>            }, 5000);undefined<br>        }undefined<br>undefined<br>        // Where are you going popup functionundefined<br>        function showWhereAreYouGoingPopup() {undefined<br>            const popup = document.createElement('div');undefined<br>            popup.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';undefined<br>            popup.innerHTML = `undefined<br>undefined<div class="bg-gradient-to-br from-yellow-100 via-orange-100 to-pink-100 rounded-2xl p-8 w-full max-w-lg mx-4 border-4 border-orange-400 shadow-2xl error-popup">undefined<br>undefined<div class="text-center">undefined<br>undefined<div class="text-8xl mb-6 bounce">🤔</div>undefined<br>undefined<h3 class="text-3xl font-bold text-orange-600 mb-4">ลาไปไหนจ๊ะ!!</h3>undefined<br>undefined<div class="bg-white rounded-lg p-4 mb-6 border-2 border-orange-200">undefined<br>undefined<div class="text-xl text-orange-700 mb-3">🕵️‍♀️ เอ๊ะ! ไม่บอกเหตุผลเหรอ?</div>undefined<br>undefined<div class="text-lg text-orange-600">กรุณาใส่เหตุผลการลาด้วยนะคะundefined<br>ไม่งั้นเราไม่รู้ว่าจะไปไหนกัน! 😅undefined</div>undefined<br>undefined</div>undefined<br>undefined<div class="flex justify-center space-x-3 mb-6">undefined<br>undefined<span class="text-3xl animate-bounce">🏖️</span>undefined<br>undefined<span class="text-3xl animate-bounce" style="animation-delay: 0.1s">🏥</span>undefined<br>undefined<span class="text-3xl animate-bounce" style="animation-delay: 0.2s">🎉</span>undefined<br>undefined<span class="text-3xl animate-bounce" style="animation-delay: 0.3s">🤷‍♀️</span>undefined<br>undefined<span class="text-3xl animate-bounce" style="animation-delay: 0.4s">❓</span>undefined<br>undefined</div>undefined<br>undefined<div class="space-y-3">undefined<br>undefined<button onclick="this.closest('.fixed').remove(); document.getElementById('leaveReason').focus();" class="w-full bg-gradient-to-r from-orange-500 to-pink-500 hover:from-orange-600 hover:to-pink-600 text-white px-8 py-4 rounded-full font-bold text-xl transform hover:scale-105 transition-all duration-200 shadow-lg">undefined<br>                                เอาล่ะ! ไปใส่เหตุผลเลย 😊undefined<br>undefined</button>undefined<br>undefined<div class="text-sm text-gray-600">💡 เช่น: ไปเที่ยว, ป่วย, ธุระส่วนตัว, งานแต่งงาน</div>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>            `;undefined<br>            document.body.appendChild(popup);undefined<br>undefined<br>            // Add shake animation to the popupundefined<br>            setTimeout(() => {undefined<br>                const popupContent = popup.querySelector('.error-popup');undefined<br>                popupContent.style.animation = 'shake 0.5s ease-in-out';undefined<br>            }, 100);undefined<br>undefined<br>            // Auto remove after 10 secondsundefined<br>            setTimeout(() => {undefined<br>                if (popup.parentNode) {undefined<br>                    popup.remove();undefined<br>                }undefined<br>            }, 10000);undefined<br>        }undefined<br>undefined<br>        // Employee selection functionundefined<br>        function selectEmployee(name) {undefined<br>            document.getElementById('employeeUsername').value = name;undefined<br>undefined<br>            // Add visual feedbackundefined<br>            const buttons = document.querySelectorAll('.employee-btn');undefined<br>            buttons.forEach(btn => {undefined<br>                btn.classList.remove('ring-4', 'ring-blue-300', 'bg-blue-200');undefined<br>            });undefined<br>undefined<br>            // Highlight selected buttonundefined<br>            event.target.closest('.employee-btn').classList.add('ring-4', 'ring-blue-300');undefined<br>undefined<br>            // Auto login after selectionundefined<br>            setTimeout(() => {undefined<br>                employeeLogin();undefined<br>            }, 500);undefined<br>        }undefined<br>undefined<br>        // Google Sheets Integration Functionsundefined<br>        let googleSheetsSettings = JSON.parse(localStorage.getItem('googleSheetsSettings')) || {undefined<br>            url: '',undefined<br>            apiKey: '',undefined<br>            autoBackup: false,undefined<br>            backupInterval: 'weekly',undefined<br>            lastBackup: nullundefined<br>        };undefined<br>undefined<br>        function testGoogleConnection() {undefined<br>            const url = document.getElementById('googleSheetsUrl').value.trim();undefined<br>undefined<br>            if (!url) {undefined<br>                showGooglePopup('ข้อผิดพลาด! 🚫', 'กรุณาใส่ URL ของ Google Sheets ก่อนนะคะ');undefined<br>                return;undefined<br>            }undefined<br>undefined<br>            // Save settingsundefined<br>            googleSheetsSettings.url = url;undefined<br>            googleSheetsSettings.apiKey = document.getElementById('googleApiKey').value.trim();undefined<br>            localStorage.setItem('googleSheetsSettings', JSON.stringify(googleSheetsSettings));undefined<br>undefined<br>            // Simulate connection testundefined<br>            showGooglePopup('ทดสอบการเชื่อมต่อ... 🔄', 'กำลังตรวจสอบการเชื่อมต่อกับ Google Sheets');undefined<br>undefined<br>            setTimeout(() => {undefined<br>                showGooglePopup('เชื่อมต่อสำเร็จ! ✅', 'ระบบสามารถเชื่อมต่อกับ Google Sheets ได้แล้วundefined<br>undefined<br>🎉 พร้อมส่งออกข้อมูลได้เลย!');undefined<br>                updateBackupStatus('เชื่อมต่อสำเร็จ - พร้อมใช้งาน');undefined<br>            }, 2000);undefined<br>        }undefined<br>undefined<br>        function exportToGoogleSheets(type) {undefined<br>            if (!googleSheetsSettings.url) {undefined<br>                showGooglePopup('ยังไม่ได้ตั้งค่า! ⚠️', 'กรุณาตั้งค่า Google Sheets URL ก่อนส่งออกข้อมูลนะคะ');undefined<br>                return;undefined<br>            }undefined<br>undefined<br>            let data = {};undefined<br>            let fileName = '';undefined<br>            let description = '';undefined<br>undefined<br>            switch(type) {undefined<br>                case 'all':undefined<br>                    data = {undefined<br>                        employees: employees,undefined<br>                        employeeBalances: employeeBalances,undefined<br>                        leaveRequests: leaveRequests,undefined<br>                        compensatoryWorkRequests: compensatoryWorkRequests,undefined<br>                        lockedDates: lockedDates,undefined<br>                        exportDate: new Date().toLocaleString('th-TH')undefined<br>                    };undefined<br>                    fileName = 'ข้อมูลระบบลาหยุดงาน_ทั้งหมด';undefined<br>                    description = 'ข้อมูลทั้งหมดในระบบ';undefined<br>                    break;undefined<br>                case 'employees':undefined<br>                    data = {undefined<br>                        employees: employees,undefined<br>                        employeeBalances: employeeBalances,undefined<br>                        exportDate: new Date().toLocaleString('th-TH')undefined<br>                    };undefined<br>                    fileName = 'ข้อมูลพนักงาน';undefined<br>                    description = 'รายชื่อพนักงานและยอดวันลา';undefined<br>                    break;undefined<br>                case 'leaves':undefined<br>                    data = {undefined<br>                        leaveRequests: leaveRequests,undefined<br>                        compensatoryWorkRequests: compensatoryWorkRequests,undefined<br>                        exportDate: new Date().toLocaleString('th-TH')undefined<br>                    };undefined<br>                    fileName = 'ประวัติการลา';undefined<br>                    description = 'ประวัติการลาทั้งหมด';undefined<br>                    break;undefined<br>                case 'balances':undefined<br>                    data = {undefined<br>                        employeeBalances: employeeBalances,undefined<br>                        exportDate: new Date().toLocaleString('th-TH')undefined<br>                    };undefined<br>                    fileName = 'ยอดวันลาคงเหลือ';undefined<br>                    description = 'ยอดวันลาคงเหลือของพนักงานทั้งหมด';undefined<br>                    break;undefined<br>            }undefined<br>undefined<br>            // Show loadingundefined<br>            showGooglePopup('กำลังส่งออกข้อมูล... 📤', `กำลังส่ง${description}ไปยัง Google Sheetsundefined<br>undefined<br>⏳ กรุณารอสักครู่...`);undefined<br>undefined<br>            // Simulate export processundefined<br>            setTimeout(() => {undefined<br>                // Create downloadable JSON file as backupundefined<br>                const jsonData = JSON.stringify(data, null, 2);undefined<br>                const blob = new Blob([jsonData], { type: 'application/json' });undefined<br>                const url = URL.createObjectURL(blob);undefined<br>                const a = document.createElement('a');undefined<br>                a.href = url;undefined<br>                a.download = `${fileName}_${new Date().toISOString().split('T')[0]}.json`;undefined<br>                document.body.appendChild(a);undefined<br>                a.click();undefined<br>                document.body.removeChild(a);undefined<br>                URL.revokeObjectURL(url);undefined<br>undefined<br>                // Update backup statusundefined<br>                googleSheetsSettings.lastBackup = new Date().toLocaleString('th-TH');undefined<br>                localStorage.setItem('googleSheetsSettings', JSON.stringify(googleSheetsSettings));undefined<br>                updateBackupStatus(`สำรองข้อมูลล่าสุด: ${googleSheetsSettings.lastBackup}`);undefined<br>undefined<br>                showGooglePopup('ส่งออกสำเร็จ! 🎉', `✅ ส่ง${description}ไปยัง Google Sheets เรียบร้อยแล้ว!undefined<br>undefined<br>📁 ไฟล์สำรองถูกดาวน์โหลดไปยังเครื่องของคุณด้วยundefined<br>undefined<br>🔗 ตรวจสอบข้อมูลได้ที่ Google Sheets`);undefined<br>            }, 3000);undefined<br>        }undefined<br>undefined<br>        function toggleAutoBackup() {undefined<br>            const autoBackup = document.getElementById('autoBackup').checked;undefined<br>            const backupInterval = document.getElementById('backupInterval');undefined<br>undefined<br>            backupInterval.disabled = !autoBackup;undefined<br>            googleSheetsSettings.autoBackup = autoBackup;undefined<br>            googleSheetsSettings.backupInterval = backupInterval.value;undefined<br>undefined<br>            localStorage.setItem('googleSheetsSettings', JSON.stringify(googleSheetsSettings));undefined<br>undefined<br>            if (autoBackup) {undefined<br>                showGooglePopup('เปิดการสำรองอัตโนมัติ! ⚡', `✅ ระบบจะสำรองข้อมูลอัตโนมัติทุก${getIntervalText(backupInterval.value)}undefined<br>undefined<br>📊 ข้อมูลจะถูกส่งไปยัง Google Sheets โดยอัตโนมัติ`);undefined<br>                scheduleAutoBackup();undefined<br>            } else {undefined<br>                showGooglePopup('ปิดการสำรองอัตโนมัติ', 'การสำรองข้อมูลอัตโนมัติถูกปิดแล้วundefined<br>คุณยังสามารถส่งออกข้อมูลด้วยตนเองได้');undefined<br>            }undefined<br>        }undefined<br>undefined<br>        function getIntervalText(interval) {undefined<br>            const intervals = {undefined<br>                'daily': 'วัน',undefined<br>                'weekly': 'สัปดาห์', undefined<br>                'monthly': 'เดือน'undefined<br>            };undefined<br>            return intervals[interval] || 'สัปดาห์';undefined<br>        }undefined<br>undefined<br>        function scheduleAutoBackup() {undefined<br>            if (!googleSheetsSettings.autoBackup) return;undefined<br>undefined<br>            const intervals = {undefined<br>                'daily': 24 * 60 * 60 * 1000,      // 1 dayundefined<br>                'weekly': 7 * 24 * 60 * 60 * 1000,  // 7 days  undefined<br>                'monthly': 30 * 24 * 60 * 60 * 1000 // 30 daysundefined<br>            };undefined<br>undefined<br>            const interval = intervals[googleSheetsSettings.backupInterval] || intervals.weekly;undefined<br>undefined<br>            setTimeout(() => {undefined<br>                if (googleSheetsSettings.autoBackup && googleSheetsSettings.url) {undefined<br>                    exportToGoogleSheets('all');undefined<br>                    scheduleAutoBackup(); // Schedule next backupundefined<br>                }undefined<br>            }, interval);undefined<br>        }undefined<br>undefined<br>        function updateBackupStatus(status) {undefined<br>            document.getElementById('backupStatus').textContent = status;undefined<br>        }undefined<br>undefined<br>        function showGooglePopup(title, message) {undefined<br>            const popup = document.createElement('div');undefined<br>            popup.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';undefined<br>            popup.innerHTML = `undefined<br>undefined<div class="bg-gradient-to-br from-green-100 via-blue-100 to-purple-100 rounded-2xl p-8 w-full max-w-lg mx-4 border-4 border-green-400 shadow-2xl">undefined<br>undefined<div class="text-center">undefined<br>undefined<div class="text-6xl mb-4">📊</div>undefined<br>undefined<h3 class="text-2xl font-bold text-green-600 mb-4">${title}</h3>undefined<br>undefined<div class="bg-white rounded-lg p-4 mb-6 border-2 border-green-200">undefined<br>undefined<div class="text-lg text-gray-700">${message}</div>undefined<br>undefined</div>undefined<br>undefined<button onclick="this.closest('.fixed').remove()" class="bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 text-white px-8 py-3 rounded-full font-bold text-lg transform hover:scale-105 transition-all duration-200 shadow-lg">undefined<br>                            เข้าใจแล้ว! 👍undefined<br>undefined</button>undefined<br>undefined</div>undefined<br>undefined</div>undefined<br>            `;undefined<br>            document.body.appendChild(popup);undefined<br>undefined<br>            // Auto remove after 8 seconds for success messagesundefined<br>            if (title.includes('สำเร็จ') || title.includes('เชื่อมต่อ')) {undefined<br>                setTimeout(() => {undefined<br>                    if (popup.parentNode) {undefined<br>                        popup.remove();undefined<br>                    }undefined<br>                }, 8000);undefined<br>            }undefined<br>        }undefined<br>undefined<br>        // Load Google Sheets settings on admin dashboardundefined<br>        function loadGoogleSheetsSettings() {undefined<br>            if (googleSheetsSettings.url) {undefined<br>                document.getElementById('googleSheetsUrl').value = googleSheetsSettings.url;undefined<br>            }undefined<br>            if (googleSheetsSettings.apiKey) {undefined<br>                document.getElementById('googleApiKey').value = googleSheetsSettings.apiKey;undefined<br>            }undefined<br>            document.getElementById('autoBackup').checked = googleSheetsSettings.autoBackup;undefined<br>            document.getElementById('backupInterval').value = googleSheetsSettings.backupInterval;undefined<br>            document.getElementById('backupInterval').disabled = !googleSheetsSettings.autoBackup;undefined<br>undefined<br>            if (googleSheetsSettings.lastBackup) {undefined<br>                updateBackupStatus(`สำรองข้อมูลล่าสุด: ${googleSheetsSettings.lastBackup}`);undefined<br>            }undefined<br>undefined<br>            // Start auto backup if enabledundefined<br>            if (googleSheetsSettings.autoBackup) {undefined<br>                scheduleAutoBackup();undefined<br>            }undefined<br>        }undefined<br>undefined<br>        // Initialize the systemundefined<br>        localStorage.setItem('employeeBalances', JSON.stringify(employeeBalances));undefined<br>undefined
        </script>undefined<br>undefined<script>
          (function() {
            function c() {
              var b = a.contentDocument || a.contentWindow.document;
              if (b) {
                var d = b.createElement('script');
                d.innerHTML = "window.__CF$cv$params={r:'979bb45125a545b2',t:'MTc1Njk3MDIxNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";
                b.getElementsByTagName('head')[0].appendChild(d)
              }
            }
            if (document.body) {
              var a = document.createElement('iframe');
              a.height = 1;
              a.width = 1;
              a.style.position = 'absolute';
              a.style.top = 0;
              a.style.left = 0;
              a.style.border = 'none';
              a.style.visibility = 'hidden';
              document.body.appendChild(a);
              if ('loading' !== document.readyState) c();
              else if (window.addEventListener) document.addEventListener('DOMContentLoaded', c);
              else {
                var e = document.onreadystatechange || function() {};
                document.onreadystatechange = function(b) {
                  e(b);
                  'loading' !== document.readyState && (document.onreadystatechange = e, c())
                }
              }
            }
          })();
        </script>undefined
      </body>undefined<br>undefined
    </html>undefined
  </body>undefined
</html>